


<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Utilities &mdash; Catalyst 20.12 documentation</title>
  

  
  
  
  

  

  
  
    

  

  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <!-- <link rel="stylesheet" href="../_static/pygments.css" type="text/css" /> -->
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Typing" href="typing.html" /> 

  
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-167094275-1"></script>
  <script src="../_static/js/googleanalytics.min.js"></script>
  
  <script src="../_static/js/modernizr.min.js"></script>

  <!-- Preload the theme fonts -->

<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-book.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-Medium.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/FreightSans/freight-sans-medium-italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="../_static/fonts/IBMPlexMono/IBMPlexMono-SemiBold.woff2" as="font" type="font/woff2" crossorigin="anonymous">

<!-- Preload the katex fonts -->

<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Math-Italic.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Main-Bold.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size1-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size4-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size2-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Size3-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
<link rel="preload" href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/fonts/KaTeX_Caligraphic-Regular.woff2" as="font" type="font/woff2" crossorigin="anonymous">
</head>

<div class="container-fluid header-holder tutorials-header" id="header-holder">
  <div class="container">
    <div class="header-container">
      <a class="header-logo" href="https://catalyst-team.com/" aria-label="Catalyst"></a>

      <div class="main-menu">
        <ul>

          <li>
            <div class="ecosystem-dropdown">
              <a id="dropdownMenuButtonEcosystem" data-toggle="ecosystem-dropdown">
                Ecosystem
              </a>
              <div class="ecosystem-dropdown-menu">
                <a class="nav-dropdown-item" href="https://alchemy.host">
                  <span class=dropdown-title>Alchemy</span>
                  <p>Experiments logging & visualization</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/catalyst">
                  <span class=dropdown-title>Catalyst</span>
                  <p>Accelerated deep learning R&D</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/reaction">
                  <span class=dropdown-title>Reaction</span>
                  <p>Convenient deep learning models serving</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <div class="projects-dropdown">
              <a id="dropdownMenuButtonProjects" data-toggle="projects-dropdown">
                Projects
              </a>
              <div class="projects-dropdown-menu">
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/codestyle">
                  <span class=dropdown-title>Codestyle</span>
                  <p>Joint R&D codestyle</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/neuro">
                  <span class=dropdown-title>Catalyst.Neuro</span>
                  <p>Catalyst.Team and TReNDS collaborative project</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/classification">
                  <span class=dropdown-title>Classification</span>
                  <p>Image classification pipeline with transfer learning</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/detection">
                  <span class=dropdown-title>Detection</span>
                  <p>Object detection pipeline</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/segmentation">
                  <span class=dropdown-title>Segmentation</span>
                  <p>Image semantic segmentation pipeline</p>
                </a>
                <a class="nav-dropdown-item" href="https://github.com/catalyst-team/gan">
                  <span class=dropdown-title>Catalyst.GAN</span>
                  <p>GAN pipelines</p>
                </a>
              </div>
            </div>
          </li>

          <li>
            <a href="https://github.com/catalyst-team/dl-course">Deep learning course</a>
          </li>
        </ul>
      </div>

      <a class="main-menu-open-button" href="#" data-behavior="open-mobile-menu"></a>
    </div>

  </div>
</div>


<body class="catalyst-body">

   

    

    <div class="table-of-contents-link-wrapper">
      <span>Table of Contents</span>
      <a href="#" class="toggle-table-of-contents" data-behavior="toggle-table-of-contents"></a>
    </div>

    <nav data-toggle="wy-nav-shift" class="catalyst-left-menu" id="catalyst-left-menu">
      <div class="catalyst-side-scroll">
        <div class="catalyst-menu catalyst-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          <div class="catalyst-left-menu-search">
            

            
              
              
                <div class="version">
                  <a href="https://catalyst-team.github.io/catalyst/versions.html">20.12</a>
                </div>
              
            

            


  


<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search Docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

            
          </div>

          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Getting started</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../index.html">Catalyst</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/quickstart.html">Quickstart 101</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/catalyst-team/catalyst#minimal-examples">Minimal examples</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting_started/migrating_from_other.html">Migrating from other libraries</a></li>
<li class="toctree-l1"><a class="reference external" href="https://medium.com/pytorch/catalyst-101-accelerated-pytorch-bd766a556d92?source=friends_link&amp;sk=d3dd9b2b23500eca046361187b4619ff">Catalyst 101 — Accelerated PyTorch</a></li>
<li class="toctree-l1"><a class="reference external" href="https://medium.com/pytorch/catalyst-102-core-trinity-experiment-runner-and-callback-54adc384b57c?source=friends_link&amp;sk=2aff824412e2f653587a30cd853b030c">Catalyst 102 — Core Trinity</a></li>
</ul>
<p class="caption"><span class="caption-text">Tutorials</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorials/ddp.html">Distributed training tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Core</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../core/experiment.html">Experiment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/runner.html">Runner</a></li>
<li class="toctree-l1"><a class="reference internal" href="../core/callback.html">Callback</a></li>
</ul>
<p class="caption"><span class="caption-text">FAQ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq/intro.html">How to make X?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/data.html">Dataflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/lr_finder.html">[WIP] Learning Rate Finder</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/dp.html">DataParallel training (cpu, single/multi-gpu)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/amp.html">Mixed precision training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/ddp.html">Distributed training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/slurm.html">Slurm training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/tpu.html">TPU training</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/multi_components.html">Multiple components</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/early_stopping.html">Early stopping</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/checkpointing.html">Model checkpointing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/debugging.html">Model debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/logging.html">Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/inference.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/finetuning.html">[WIP] Finetuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/stages.html">[WIP] Multi-stage experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/config_api.html">[WIP] Config API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/optuna.html">Optuna integration</a></li>
</ul>
<p class="caption"><span class="caption-text">Contribution guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://github.com/catalyst-team/catalyst/blob/master/CONTRIBUTING.md">How to start</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/catalyst-team/codestyle">Codestyle</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/catalyst-team/catalyst#acknowledgments">Acknowledgments</a></li>
</ul>
<p class="caption"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="callbacks.html">Callbacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="contrib.html">Contrib</a></li>
<li class="toctree-l1"><a class="reference internal" href="core.html">Core</a></li>
<li class="toctree-l1"><a class="reference internal" href="data.html">Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="experiments.html">Experiments</a></li>
<li class="toctree-l1"><a class="reference internal" href="metrics.html">Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="registry.html">Registry</a></li>
<li class="toctree-l1"><a class="reference internal" href="runners.html">Runners</a></li>
<li class="toctree-l1"><a class="reference internal" href="settings.html">Settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l1"><a class="reference internal" href="typing.html">Typing</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Utilities</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <div class="catalyst-container">
      <div class="catalyst-page-level-bar" id="catalyst-page-level-bar">
        <div class="catalyst-breadcrumbs-wrapper">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="catalyst-breadcrumbs">
    
      <li>
        <a href="../index.html">
          
            Docs
          
        </a> &gt;
      </li>

        
      <li>Utilities</li>
    
    
      <li class="catalyst-breadcrumbs-aside">
        
            
            
              <a href="https://github.com/catalyst-team/catalyst/blob/master/docs/api/utils.rst" class="fa fa-github"> Edit on GitHub</a>
            
          
        
      </li>
    
  </ul>

  
</div>
        </div>

        <div class="catalyst-shortcuts-wrapper" id="catalyst-shortcuts-wrapper">
          Shortcuts
        </div>
      </div>

      <section data-toggle="wy-nav-shift" id="catalyst-content-wrap" class="catalyst-content-wrap">
        <div class="catalyst-content-left">
          
          <div class="rst-content">
          
            <div role="main" class="main-content" itemscope="itemscope" itemtype="http://schema.org/Article">
             <article itemprop="articleBody" id="catalyst-article" class="catalyst-article">
              
  <div class="section" id="utilities">
<h1>Utilities<a class="headerlink" href="#utilities" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#module-catalyst.utils" id="id2">Main</a></p>
<ul>
<li><p><a class="reference internal" href="#module-catalyst.utils.checkpoint" id="id3">Checkpoint</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.components" id="id4">Components</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.config" id="id5">Config</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.distributed" id="id6">Distributed</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.loaders" id="id7">Loaders</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.misc" id="id8">Misc</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.numpy" id="id9">Numpy</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.parser" id="id10">Parser</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.pruning" id="id11">Pruning</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.quantization" id="id12">Quantization</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.scripts" id="id13">Scripts</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.swa" id="id14">Stochastic Weights Averaging (SWA)</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.sys" id="id15">Sys</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.torch" id="id16">Torch</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.utils.tracing" id="id17">Tracing</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.utils" id="id18">Contrib</a></p>
<ul>
<li><p><a class="reference internal" href="#module-catalyst.contrib.utils.compression" id="id19">Compression</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.utils.pandas" id="id20">Pandas</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.utils.parallel" id="id21">Parallel</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.utils.plotly" id="id22">Plotly</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.utils.serialization" id="id23">Serialization</a></p></li>
<li><p><a class="reference internal" href="#id1" id="id24">Torch</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.utils.visualization" id="id25">Visualization</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.utils.wizard" id="id26">Wizard</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.utils.cv" id="id27">Computer Vision</a></p>
<ul>
<li><p><a class="reference internal" href="#module-catalyst.contrib.utils.cv.image" id="id28">Image</a></p></li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.utils.cv.tensor" id="id29">Tensor</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#module-catalyst.contrib.utils.nlp" id="id30">Natural language processing</a></p>
<ul>
<li><p><a class="reference internal" href="#module-catalyst.contrib.utils.nlp.text" id="id31">Text</a></p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="module-catalyst.utils">
<span id="main"></span><h2><a class="toc-backref" href="#id2">Main</a><a class="headerlink" href="#module-catalyst.utils" title="Permalink to this headline">¶</a></h2>
<p>All utils are gathered in <a class="reference internal" href="#module-catalyst.utils" title="catalyst.utils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">catalyst.utils</span></code></a> for easier access.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Everything from <a class="reference internal" href="#module-catalyst.contrib.utils" title="catalyst.contrib.utils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">catalyst.contrib.utils</span></code></a> is included in <a class="reference internal" href="#module-catalyst.utils" title="catalyst.utils"><code class="xref py py-mod docutils literal notranslate"><span class="pre">catalyst.utils</span></code></a></p>
</div>
<div class="section" id="module-catalyst.utils.checkpoint">
<span id="checkpoint"></span><h3><a class="toc-backref" href="#id3">Checkpoint</a><a class="headerlink" href="#module-catalyst.utils.checkpoint" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.utils.checkpoint.pack_checkpoint">
<code class="sig-prename descclassname">catalyst.utils.checkpoint.</code><code class="sig-name descname">pack_checkpoint</code><span class="sig-paren">(</span><em class="sig-param">model: torch.nn.modules.module.Module = None</em>, <em class="sig-param">criterion: torch.nn.modules.module.Module = None</em>, <em class="sig-param">optimizer=None</em>, <em class="sig-param">scheduler=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/checkpoint.html#pack_checkpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.checkpoint.pack_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Packs <code class="docutils literal notranslate"><span class="pre">model</span></code>, <code class="docutils literal notranslate"><span class="pre">criterion</span></code>, <code class="docutils literal notranslate"><span class="pre">optimizer</span></code>, <code class="docutils literal notranslate"><span class="pre">scheduler</span></code>
and some extra info <code class="docutils literal notranslate"><span class="pre">**kwargs</span></code> to torch-based checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – torch model</p></li>
<li><p><strong>criterion</strong> – torch criterion</p></li>
<li><p><strong>optimizer</strong> – torch optimizer</p></li>
<li><p><strong>scheduler</strong> – torch scheduler</p></li>
<li><p><strong>**kwargs</strong> – some extra info to pack</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>torch-based checkpoint with <code class="docutils literal notranslate"><span class="pre">model_state_dict</span></code>,
<code class="docutils literal notranslate"><span class="pre">criterion_state_dict</span></code>, <code class="docutils literal notranslate"><span class="pre">optimizer_state_dict</span></code>,
<code class="docutils literal notranslate"><span class="pre">scheduler_state_dict</span></code> keys.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.checkpoint.unpack_checkpoint">
<code class="sig-prename descclassname">catalyst.utils.checkpoint.</code><code class="sig-name descname">unpack_checkpoint</code><span class="sig-paren">(</span><em class="sig-param">checkpoint</em>, <em class="sig-param">model=None</em>, <em class="sig-param">criterion=None</em>, <em class="sig-param">optimizer=None</em>, <em class="sig-param">scheduler=None</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/utils/checkpoint.html#unpack_checkpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.checkpoint.unpack_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Load checkpoint from file and unpack the content to a model
(if not None), criterion (if not None), optimizer (if not None),
scheduler (if not None).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>checkpoint</strong> – checkpoint to load</p></li>
<li><p><strong>model</strong> – model where should be updated state</p></li>
<li><p><strong>criterion</strong> – criterion where should be updated state</p></li>
<li><p><strong>optimizer</strong> – optimizer where should be updated state</p></li>
<li><p><strong>scheduler</strong> – scheduler where should be updated state</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.checkpoint.save_checkpoint">
<code class="sig-prename descclassname">catalyst.utils.checkpoint.</code><code class="sig-name descname">save_checkpoint</code><span class="sig-paren">(</span><em class="sig-param">checkpoint: Dict, logdir: Union[pathlib.Path, str], suffix: str, is_best: bool = False, is_last: bool = False, special_suffix: str = '', saver_fn: Callable = &lt;function save&gt;</em><span class="sig-paren">)</span> &#x2192; Union[pathlib.Path, str]<a class="reference internal" href="../_modules/catalyst/utils/checkpoint.html#save_checkpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.checkpoint.save_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Saving checkpoint to a file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>checkpoint</strong> – data to save.</p></li>
<li><p><strong>logdir</strong> – directory where checkpoint
should be stored.</p></li>
<li><p><strong>suffix</strong> – checkpoint file name.</p></li>
<li><p><strong>is_best</strong> – if <code class="docutils literal notranslate"><span class="pre">True</span></code> then also
will be generated best checkpoint file.</p></li>
<li><p><strong>is_last</strong> – if <code class="docutils literal notranslate"><span class="pre">True</span></code> then also
will be generated last checkpoint file.</p></li>
<li><p><strong>special_suffix</strong> – suffix to use for
saving best/last checkpoints.</p></li>
<li><p><strong>saver_fn</strong> – function to use for saving
data to file, default is <code class="docutils literal notranslate"><span class="pre">torch.save</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>path to saved checkpoint</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.checkpoint.load_checkpoint">
<code class="sig-prename descclassname">catalyst.utils.checkpoint.</code><code class="sig-name descname">load_checkpoint</code><span class="sig-paren">(</span><em class="sig-param">filepath: str</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/checkpoint.html#load_checkpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.checkpoint.load_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Load checkpoint from path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filepath</strong> – checkpoint file to load</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>checkpoint content</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-catalyst.utils.components">
<span id="components"></span><h3><a class="toc-backref" href="#id4">Components</a><a class="headerlink" href="#module-catalyst.utils.components" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.utils.components.process_components">
<code class="sig-prename descclassname">catalyst.utils.components.</code><code class="sig-name descname">process_components</code><span class="sig-paren">(</span><em class="sig-param">model: torch.nn.modules.module.Module</em>, <em class="sig-param">criterion: torch.nn.modules.module.Module = None</em>, <em class="sig-param">optimizer: torch.optim.optimizer.Optimizer = None</em>, <em class="sig-param">scheduler: torch.optim.lr_scheduler._LRScheduler = None</em>, <em class="sig-param">distributed_params: Dict = None</em>, <em class="sig-param">device: Union[str</em>, <em class="sig-param">torch.device] = None</em><span class="sig-paren">)</span> &#x2192; Tuple[torch.nn.modules.module.Module, torch.nn.modules.module.Module, torch.optim.optimizer.Optimizer, torch.optim.lr_scheduler._LRScheduler, Union[str, torch.device]]<a class="reference internal" href="../_modules/catalyst/utils/components.html#process_components"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.components.process_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the processed model, criterion, optimizer, scheduler and device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – torch model</p></li>
<li><p><strong>criterion</strong> – criterion function</p></li>
<li><p><strong>optimizer</strong> – optimizer</p></li>
<li><p><strong>scheduler</strong> – scheduler</p></li>
<li><p><strong>distributed_params</strong> (<em>dict</em><em>, </em><em>optional</em>) – dict with the parameters
for distributed and FP16 method</p></li>
<li><p><strong>device</strong> (<em>Device</em><em>, </em><em>optional</em>) – device</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple with processed model, criterion, optimizer, scheduler and device.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ValueError</strong> – if device is None and TPU available,
    for using TPU need to manualy move model/optimizer/scheduler
    to a TPU device and pass device to a function.</p></li>
<li><p><strong>NotImplementedError</strong> – if model is not nn.Module or dict for multi-gpu,
    nn.ModuleDict for DataParallel not implemented yet</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-catalyst.utils.config">
<span id="config"></span><h3><a class="toc-backref" href="#id5">Config</a><a class="headerlink" href="#module-catalyst.utils.config" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.utils.config.load_config">
<code class="sig-prename descclassname">catalyst.utils.config.</code><code class="sig-name descname">load_config</code><span class="sig-paren">(</span><em class="sig-param">path: Union[str, pathlib.Path], ordered: bool = False, data_format: str = None, encoding: str = 'utf-8'</em><span class="sig-paren">)</span> &#x2192; Union[Dict, List]<a class="reference internal" href="../_modules/catalyst/utils/config.html#load_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.config.load_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads config by giving path. Supports YAML and JSON files.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">load</span><span class="p">(</span><span class="n">path</span><span class="o">=</span><span class="s2">&quot;./config.yml&quot;</span><span class="p">,</span> <span class="n">ordered</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path</strong> – path to config file (YAML or JSON)</p></li>
<li><p><strong>ordered</strong> – if true the config will be loaded as <code class="docutils literal notranslate"><span class="pre">OrderedDict</span></code></p></li>
<li><p><strong>data_format</strong> – <code class="docutils literal notranslate"><span class="pre">yaml</span></code>, <code class="docutils literal notranslate"><span class="pre">yml</span></code> or <code class="docutils literal notranslate"><span class="pre">json</span></code>.</p></li>
<li><p><strong>encoding</strong> – encoding to read the config</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>config</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Union[Dict, List]</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>Exception</strong> – if path <code class="docutils literal notranslate"><span class="pre">path</span></code> doesn’t exists
    or file format is not YAML or JSON</p>
</dd>
</dl>
<p>Adapted from
<a class="reference external" href="https://github.com/TezRomacH/safitty/blob/v1.2.0/safitty/parser.py#L63">https://github.com/TezRomacH/safitty/blob/v1.2.0/safitty/parser.py#L63</a>
which was adapted from
<a class="reference external" href="https://github.com/catalyst-team/catalyst/blob/v19.03/catalyst/utils/config.py#L10">https://github.com/catalyst-team/catalyst/blob/v19.03/catalyst/utils/config.py#L10</a></p>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.config.save_config">
<code class="sig-prename descclassname">catalyst.utils.config.</code><code class="sig-name descname">save_config</code><span class="sig-paren">(</span><em class="sig-param">config: Union[Dict, List], path: Union[str, pathlib.Path], data_format: str = None, encoding: str = 'utf-8', ensure_ascii: bool = False, indent: int = 2</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/utils/config.html#save_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.config.save_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves config to file. Path must be either YAML or JSON.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<em>Union</em><em>[</em><em>Dict</em><em>, </em><em>List</em><em>]</em>) – config to save</p></li>
<li><p><strong>path</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) – path to save</p></li>
<li><p><strong>data_format</strong> – <code class="docutils literal notranslate"><span class="pre">yaml</span></code>, <code class="docutils literal notranslate"><span class="pre">yml</span></code> or <code class="docutils literal notranslate"><span class="pre">json</span></code>.</p></li>
<li><p><strong>encoding</strong> – Encoding to write file. Default is <code class="docutils literal notranslate"><span class="pre">utf-8</span></code></p></li>
<li><p><strong>ensure_ascii</strong> – Used for JSON, if True non-ASCII</p></li>
<li><p><strong>are escaped in JSON strings.</strong> (<em>characters</em>) – </p></li>
<li><p><strong>indent</strong> – Used for JSON</p></li>
</ul>
</dd>
</dl>
<p>Adapted from
<a class="reference external" href="https://github.com/TezRomacH/safitty/blob/v1.2.0/safitty/parser.py#L110">https://github.com/TezRomacH/safitty/blob/v1.2.0/safitty/parser.py#L110</a>
which was adapted from
<a class="reference external" href="https://github.com/catalyst-team/catalyst/blob/v19.03/catalyst/utils/config.py#L38">https://github.com/catalyst-team/catalyst/blob/v19.03/catalyst/utils/config.py#L38</a></p>
</dd></dl>

</div>
<div class="section" id="module-catalyst.utils.distributed">
<span id="distributed"></span><h3><a class="toc-backref" href="#id6">Distributed</a><a class="headerlink" href="#module-catalyst.utils.distributed" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.utils.distributed.check_ddp_wrapped">
<code class="sig-prename descclassname">catalyst.utils.distributed.</code><code class="sig-name descname">check_ddp_wrapped</code><span class="sig-paren">(</span><em class="sig-param">model: torch.nn.modules.module.Module</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="../_modules/catalyst/utils/distributed.html#check_ddp_wrapped"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.distributed.check_ddp_wrapped" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks whether model is wrapped with DataParallel/DistributedDataParallel.</p>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.distributed.check_apex_available">
<code class="sig-prename descclassname">catalyst.utils.distributed.</code><code class="sig-name descname">check_apex_available</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="../_modules/catalyst/utils/distributed.html#check_apex_available"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.distributed.check_apex_available" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if apex is available.</p>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.distributed.check_amp_available">
<code class="sig-prename descclassname">catalyst.utils.distributed.</code><code class="sig-name descname">check_amp_available</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="../_modules/catalyst/utils/distributed.html#check_amp_available"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.distributed.check_amp_available" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if torch.amp is available.</p>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.distributed.check_torch_distributed_initialized">
<code class="sig-prename descclassname">catalyst.utils.distributed.</code><code class="sig-name descname">check_torch_distributed_initialized</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="../_modules/catalyst/utils/distributed.html#check_torch_distributed_initialized"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.distributed.check_torch_distributed_initialized" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if torch.distributed is available and initialized.</p>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.distributed.check_slurm_available">
<code class="sig-prename descclassname">catalyst.utils.distributed.</code><code class="sig-name descname">check_slurm_available</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/distributed.html#check_slurm_available"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.distributed.check_slurm_available" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if slurm is available.</p>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.distributed.assert_fp16_available">
<code class="sig-prename descclassname">catalyst.utils.distributed.</code><code class="sig-name descname">assert_fp16_available</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/utils/distributed.html#assert_fp16_available"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.distributed.assert_fp16_available" title="Permalink to this definition">¶</a></dt>
<dd><p>Asserts for installed and available Apex FP16.</p>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.distributed.initialize_apex">
<code class="sig-prename descclassname">catalyst.utils.distributed.</code><code class="sig-name descname">initialize_apex</code><span class="sig-paren">(</span><em class="sig-param">model</em>, <em class="sig-param">optimizer=None</em>, <em class="sig-param">**distributed_params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/distributed.html#initialize_apex"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.distributed.initialize_apex" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares model and optimizer for work with Nvidia Apex.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – torch model</p></li>
<li><p><strong>optimizer</strong> – torch optimizer</p></li>
<li><p><strong>**distributed_params</strong> – extra params for <code class="docutils literal notranslate"><span class="pre">apex.amp.initialize</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>model and optimiezer, wrapped with Nvidia Apex initialization</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.distributed.get_nn_from_ddp_module">
<code class="sig-prename descclassname">catalyst.utils.distributed.</code><code class="sig-name descname">get_nn_from_ddp_module</code><span class="sig-paren">(</span><em class="sig-param">model: torch.nn.modules.module.Module</em><span class="sig-paren">)</span> &#x2192; torch.nn.modules.module.Module<a class="reference internal" href="../_modules/catalyst/utils/distributed.html#get_nn_from_ddp_module"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.distributed.get_nn_from_ddp_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a real model from a torch.nn.DataParallel,
torch.nn.parallel.DistributedDataParallel, or
apex.parallel.DistributedDataParallel.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> – A model, or DataParallel wrapper.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A model</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.distributed.get_rank">
<code class="sig-prename descclassname">catalyst.utils.distributed.</code><code class="sig-name descname">get_rank</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; int<a class="reference internal" href="../_modules/catalyst/utils/distributed.html#get_rank"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.distributed.get_rank" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the rank of the current worker.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">rank</span></code> if torch.distributed is initialized, otherwise <code class="docutils literal notranslate"><span class="pre">-1</span></code></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.distributed.get_distributed_mean">
<code class="sig-prename descclassname">catalyst.utils.distributed.</code><code class="sig-name descname">get_distributed_mean</code><span class="sig-paren">(</span><em class="sig-param">value: Union[float, torch.Tensor]</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/distributed.html#get_distributed_mean"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.distributed.get_distributed_mean" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes distributed mean among all nodes.</p>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.distributed.get_distributed_env">
<code class="sig-prename descclassname">catalyst.utils.distributed.</code><code class="sig-name descname">get_distributed_env</code><span class="sig-paren">(</span><em class="sig-param">local_rank: int</em>, <em class="sig-param">rank: int</em>, <em class="sig-param">world_size: int</em>, <em class="sig-param">use_cuda_visible_devices: bool = True</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/distributed.html#get_distributed_env"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.distributed.get_distributed_env" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns environment copy with extra distributed settings.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>local_rank</strong> – worker local rank</p></li>
<li><p><strong>rank</strong> – worker global rank</p></li>
<li><p><strong>world_size</strong> – worker world size</p></li>
<li><p><strong>use_cuda_visible_devices</strong> – boolean flag to use available GPU devices</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>updated environment copy</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.distributed.get_distributed_params">
<code class="sig-prename descclassname">catalyst.utils.distributed.</code><code class="sig-name descname">get_distributed_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/distributed.html#get_distributed_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.distributed.get_distributed_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns distributed params for experiment run.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>dictionary with distributed params</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.distributed.get_slurm_params">
<code class="sig-prename descclassname">catalyst.utils.distributed.</code><code class="sig-name descname">get_slurm_params</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/distributed.html#get_slurm_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.distributed.get_slurm_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Return slurm params for experiment run.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl class="simple">
<dt>tuple with current node index, number of nodes, master node</dt><dd><p>and master port</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-catalyst.utils.loaders">
<span id="loaders"></span><h3><a class="toc-backref" href="#id7">Loaders</a><a class="headerlink" href="#module-catalyst.utils.loaders" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.utils.loaders.get_native_batch_from_loader">
<code class="sig-prename descclassname">catalyst.utils.loaders.</code><code class="sig-name descname">get_native_batch_from_loader</code><span class="sig-paren">(</span><em class="sig-param">loader: torch.utils.data.dataloader.DataLoader</em>, <em class="sig-param">batch_index: int = 0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/loaders.html#get_native_batch_from_loader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.loaders.get_native_batch_from_loader" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a batch from experiment loader</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loader</strong> – Loader to get batch from</p></li>
<li><p><strong>batch_index</strong> – Index of batch to take from dataset of the loader</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>batch from loader</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.loaders.get_native_batch_from_loaders">
<code class="sig-prename descclassname">catalyst.utils.loaders.</code><code class="sig-name descname">get_native_batch_from_loaders</code><span class="sig-paren">(</span><em class="sig-param">loaders: Dict[str, torch.utils.data.dataloader.DataLoader], loader: Union[str, int] = 0, batch_index: int = 0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/loaders.html#get_native_batch_from_loaders"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.loaders.get_native_batch_from_loaders" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a batch from experiment loaders by its index or name.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loaders</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>DataLoader</em><em>]</em>) – Loaders list to get loader from</p></li>
<li><p><strong>loader</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em>) – Loader name or its index, default is zero</p></li>
<li><p><strong>batch_index</strong> – Index of batch to take from dataset of the loader</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>batch from loader</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>TypeError</strong> – if loader parameter is not a string or an integer</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.loaders.get_loader">
<code class="sig-prename descclassname">catalyst.utils.loaders.</code><code class="sig-name descname">get_loader</code><span class="sig-paren">(</span><em class="sig-param">data_source: Iterable[dict], open_fn: Callable, dict_transform: Callable = None, sampler=None, collate_fn: Callable = &lt;function default_collate&gt;, batch_size: int = 32, num_workers: int = 4, shuffle: bool = False, drop_last: bool = False</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/loaders.html#get_loader"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.loaders.get_loader" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a DataLoader from given source and its open/transform params.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>data_source</strong> – and iterable containing your
data annotations,
(for example path to images, labels, bboxes, etc)</p></li>
<li><p><strong>open_fn</strong> – function, that can open your
annotations dict and
transfer it to data, needed by your network
(for example open image by path, or tokenize read string)</p></li>
<li><p><strong>dict_transform</strong> – transforms to use on dict
(for example normalize image, add blur, crop/resize/etc)</p></li>
<li><p><strong>sampler</strong> (<em>Sampler</em><em>, </em><em>optional</em>) – defines the strategy to draw samples from
the dataset</p></li>
<li><p><strong>collate_fn</strong> (<em>callable</em><em>, </em><em>optional</em>) – merges a list of samples to form a
mini-batch of Tensor(s).  Used when using batched loading from a
map-style dataset</p></li>
<li><p><strong>batch_size</strong> (<em>int</em><em>, </em><em>optional</em>) – how many samples per batch to load</p></li>
<li><p><strong>num_workers</strong> (<em>int</em><em>, </em><em>optional</em>) – how many subprocesses to use for data
loading. <code class="docutils literal notranslate"><span class="pre">0</span></code> means that the data will be loaded
in the main process</p></li>
<li><p><strong>shuffle</strong> (<em>bool</em><em>, </em><em>optional</em>) – set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to have the data reshuffled
at every epoch (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>).</p></li>
<li><p><strong>drop_last</strong> (<em>bool</em><em>, </em><em>optional</em>) – set to <code class="docutils literal notranslate"><span class="pre">True</span></code> to drop
the last incomplete batch, if the dataset size is not divisible
by the batch size. If <code class="docutils literal notranslate"><span class="pre">False</span></code> and the size of dataset
is not divisible by the batch size, then the last batch
will be smaller. (default: <code class="docutils literal notranslate"><span class="pre">False</span></code>)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DataLoader with <code class="docutils literal notranslate"><span class="pre">catalyst.data.ListDataset</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.loaders.validate_loaders">
<code class="sig-prename descclassname">catalyst.utils.loaders.</code><code class="sig-name descname">validate_loaders</code><span class="sig-paren">(</span><em class="sig-param">loaders: Dict[str, torch.utils.data.dataloader.DataLoader]</em><span class="sig-paren">)</span> &#x2192; Dict[str, torch.utils.data.dataloader.DataLoader]<a class="reference internal" href="../_modules/catalyst/utils/loaders.html#validate_loaders"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.loaders.validate_loaders" title="Permalink to this definition">¶</a></dt>
<dd><p>Check pytorch dataloaders for distributed setup.
Transfers them to distirbuted mode if necessary.
(Experimental feature)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>loaders</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>DataLoader</em><em>]</em>) – dictionery with pytorch dataloaders</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>dictionery</dt><dd><p>with pytorch dataloaders (with distributed samplers if necessary)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dict[str, DataLoader]</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.loaders.get_loaders_from_params">
<code class="sig-prename descclassname">catalyst.utils.loaders.</code><code class="sig-name descname">get_loaders_from_params</code><span class="sig-paren">(</span><em class="sig-param">batch_size: int = 1</em>, <em class="sig-param">num_workers: int = 0</em>, <em class="sig-param">drop_last: bool = False</em>, <em class="sig-param">per_gpu_scaling: bool = False</em>, <em class="sig-param">loaders_params: Dict[str</em>, <em class="sig-param">Any] = None</em>, <em class="sig-param">samplers_params: Dict[str</em>, <em class="sig-param">Any] = None</em>, <em class="sig-param">initial_seed: int = 42</em>, <em class="sig-param">get_datasets_fn: Callable = None</em>, <em class="sig-param">**data_params</em><span class="sig-paren">)</span> &#x2192; OrderedDict[str, DataLoader]<a class="reference internal" href="../_modules/catalyst/utils/loaders.html#get_loaders_from_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.loaders.get_loaders_from_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates pytorch dataloaders from datasets and additional parameters.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> – <code class="docutils literal notranslate"><span class="pre">batch_size</span></code> parameter
from <code class="docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code></p></li>
<li><p><strong>num_workers</strong> – <code class="docutils literal notranslate"><span class="pre">num_workers</span></code> parameter
from <code class="docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code></p></li>
<li><p><strong>drop_last</strong> – <code class="docutils literal notranslate"><span class="pre">drop_last</span></code> parameter
from <code class="docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code></p></li>
<li><p><strong>per_gpu_scaling</strong> – boolean flag,
if <code class="docutils literal notranslate"><span class="pre">True</span></code>, scales batch_size in proportion to the number of GPUs</p></li>
<li><p><strong>loaders_params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – additional loaders parameters</p></li>
<li><p><strong>samplers_params</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>Any</em><em>]</em>) – additional sampler parameters</p></li>
<li><p><strong>initial_seed</strong> – initial seed for <code class="docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code>
workers</p></li>
<li><p><strong>get_datasets_fn</strong> (<em>Callable</em>) – callable function to get dictionary with
<code class="docutils literal notranslate"><span class="pre">torch.utils.data.Datasets</span></code></p></li>
<li><p><strong>**data_params</strong> – additional data parameters
or dictionary with <code class="docutils literal notranslate"><span class="pre">torch.utils.data.Datasets</span></code> to use for
pytorch dataloaders creation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>dictionary with</dt><dd><p><code class="docutils literal notranslate"><span class="pre">torch.utils.data.DataLoader</span></code></p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>OrderedDict[str, DataLoader]</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>NotImplementedError</strong> – if datasource is out of <cite>Dataset</cite> or dict</p></li>
<li><p><strong>ValueError</strong> – if batch_sampler option is mutually
    exclusive with distributed</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt>
<code class="sig-prename descclassname">catalyst.utils.loaders.</code><code class="sig-name descname">validate_loaders</code><span class="sig-paren">(</span><em class="sig-param">loaders: Dict[str, torch.utils.data.dataloader.DataLoader]</em><span class="sig-paren">)</span> &#x2192; Dict[str, torch.utils.data.dataloader.DataLoader]<a class="reference internal" href="../_modules/catalyst/utils/loaders.html#validate_loaders"><span class="viewcode-link">[source]</span></a></dt>
<dd><p>Check pytorch dataloaders for distributed setup.
Transfers them to distirbuted mode if necessary.
(Experimental feature)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>loaders</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>DataLoader</em><em>]</em>) – dictionery with pytorch dataloaders</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>dictionery</dt><dd><p>with pytorch dataloaders (with distributed samplers if necessary)</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dict[str, DataLoader]</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-catalyst.utils.misc">
<span id="misc"></span><h3><a class="toc-backref" href="#id8">Misc</a><a class="headerlink" href="#module-catalyst.utils.misc" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.utils.misc.boolean_flag">
<code class="sig-prename descclassname">catalyst.utils.misc.</code><code class="sig-name descname">boolean_flag</code><span class="sig-paren">(</span><em class="sig-param">parser: argparse.ArgumentParser</em>, <em class="sig-param">name: str</em>, <em class="sig-param">default: Optional[bool] = False</em>, <em class="sig-param">help: str = None</em>, <em class="sig-param">shorthand: str = None</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/utils/misc.html#boolean_flag"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.misc.boolean_flag" title="Permalink to this definition">¶</a></dt>
<dd><p>Add a boolean flag to a parser inplace.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">boolean_flag</span><span class="p">(</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">parser</span><span class="p">,</span> <span class="s2">&quot;flag&quot;</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;some flag&quot;</span><span class="p">,</span> <span class="n">shorthand</span><span class="o">=</span><span class="s2">&quot;f&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parser</strong> – parser to add the flag to</p></li>
<li><p><strong>name</strong> – argument name
–&lt;name&gt; will enable the flag,
while –no-&lt;name&gt; will disable it</p></li>
<li><p><strong>default</strong> (<em>bool</em><em>, </em><em>optional</em>) – default value of the flag</p></li>
<li><p><strong>help</strong> – help string for the flag</p></li>
<li><p><strong>shorthand</strong> – shorthand string for the argument</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.misc.copy_directory">
<code class="sig-prename descclassname">catalyst.utils.misc.</code><code class="sig-name descname">copy_directory</code><span class="sig-paren">(</span><em class="sig-param">input_dir: pathlib.Path</em>, <em class="sig-param">output_dir: pathlib.Path</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/utils/misc.html#copy_directory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.misc.copy_directory" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursively copies the input directory.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_dir</strong> – input directory</p></li>
<li><p><strong>output_dir</strong> – output directory</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.misc.format_metric">
<code class="sig-prename descclassname">catalyst.utils.misc.</code><code class="sig-name descname">format_metric</code><span class="sig-paren">(</span><em class="sig-param">name: str</em>, <em class="sig-param">value: float</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="../_modules/catalyst/utils/misc.html#format_metric"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.misc.format_metric" title="Permalink to this definition">¶</a></dt>
<dd><p>Format metric.</p>
<p>Metric will be returned in the scientific format if 4
decimal chars are not enough (metric value lower than 1e-4).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – metric name</p></li>
<li><p><strong>value</strong> – value of metric</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>formatted metric</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.misc.get_fn_default_params">
<code class="sig-prename descclassname">catalyst.utils.misc.</code><code class="sig-name descname">get_fn_default_params</code><span class="sig-paren">(</span><em class="sig-param">fn: Callable[..., Any], exclude: List[str] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/misc.html#get_fn_default_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.misc.get_fn_default_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Return default parameters of Callable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fn</strong> (<em>Callable</em><em>[</em><em>..</em><em>, </em><em>Any</em><em>]</em>) – target Callable</p></li>
<li><p><strong>exclude</strong> – exclude list of parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>contains default parameters of <cite>fn</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.misc.get_fn_argsnames">
<code class="sig-prename descclassname">catalyst.utils.misc.</code><code class="sig-name descname">get_fn_argsnames</code><span class="sig-paren">(</span><em class="sig-param">fn: Callable[..., Any], exclude: List[str] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/misc.html#get_fn_argsnames"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.misc.get_fn_argsnames" title="Permalink to this definition">¶</a></dt>
<dd><p>Return parameter names of Callable.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fn</strong> (<em>Callable</em><em>[</em><em>..</em><em>, </em><em>Any</em><em>]</em>) – target Callable</p></li>
<li><p><strong>exclude</strong> – exclude list of parameters</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>contains parameter names of <cite>fn</cite></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.misc.get_utcnow_time">
<code class="sig-prename descclassname">catalyst.utils.misc.</code><code class="sig-name descname">get_utcnow_time</code><span class="sig-paren">(</span><em class="sig-param">format: str = None</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="../_modules/catalyst/utils/misc.html#get_utcnow_time"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.misc.get_utcnow_time" title="Permalink to this definition">¶</a></dt>
<dd><p>Return string with current utc time in chosen format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>format</strong> – format string. if None “%y%m%d.%H%M%S” will be used.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>formatted utc time string</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.misc.is_exception">
<code class="sig-prename descclassname">catalyst.utils.misc.</code><code class="sig-name descname">is_exception</code><span class="sig-paren">(</span><em class="sig-param">ex: Any</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="../_modules/catalyst/utils/misc.html#is_exception"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.misc.is_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the argument is of <code class="docutils literal notranslate"><span class="pre">Exception</span></code> type.</p>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.misc.maybe_recursive_call">
<code class="sig-prename descclassname">catalyst.utils.misc.</code><code class="sig-name descname">maybe_recursive_call</code><span class="sig-paren">(</span><em class="sig-param">object_or_dict, method: Union[str, Callable], recursive_args=None, recursive_kwargs=None, **kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/misc.html#maybe_recursive_call"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.misc.maybe_recursive_call" title="Permalink to this definition">¶</a></dt>
<dd><p>Calls the <code class="docutils literal notranslate"><span class="pre">method</span></code> recursively for the <code class="docutils literal notranslate"><span class="pre">object_or_dict</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>object_or_dict</strong> – some object or a dictionary of objects</p></li>
<li><p><strong>method</strong> – method name to call</p></li>
<li><p><strong>recursive_args</strong> – list of arguments to pass to the <code class="docutils literal notranslate"><span class="pre">method</span></code></p></li>
<li><p><strong>recursive_kwargs</strong> – list of key-arguments to pass to the <code class="docutils literal notranslate"><span class="pre">method</span></code></p></li>
<li><p><strong>**kwargs</strong> – Arbitrary keyword arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>result of <cite>method</cite> call</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.misc.get_attr">
<code class="sig-prename descclassname">catalyst.utils.misc.</code><code class="sig-name descname">get_attr</code><span class="sig-paren">(</span><em class="sig-param">obj: Any</em>, <em class="sig-param">key: str</em>, <em class="sig-param">inner_key: str = None</em><span class="sig-paren">)</span> &#x2192; Any<a class="reference internal" href="../_modules/catalyst/utils/misc.html#get_attr"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.misc.get_attr" title="Permalink to this definition">¶</a></dt>
<dd><p>Alias for python <cite>getattr</cite> method. Useful for Callbacks preparation
and cases with multi-criterion, multi-optimizer setup.
For example, when you would like to train multi-task classification.</p>
<p>Used to get a named attribute from a <cite>IRunner</cite> by <cite>key</cite> keyword;
for example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">get_attr</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="s2">&quot;criterion&quot;</span><span class="p">)</span>
<span class="c1"># is equivalent to</span>
<span class="n">runner</span><span class="o">.</span><span class="n">criterion</span>

<span class="n">get_attr</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="s2">&quot;optimizer&quot;</span><span class="p">)</span>
<span class="c1"># is equivalent to</span>
<span class="n">runner</span><span class="o">.</span><span class="n">optimizer</span>

<span class="n">get_attr</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="s2">&quot;scheduler&quot;</span><span class="p">)</span>
<span class="c1"># is equivalent to</span>
<span class="n">runner</span><span class="o">.</span><span class="n">scheduler</span>
</pre></div>
</div>
<p>With <cite>inner_key</cite> usage, it suppose to find a dictionary under <cite>key</cite>    and would get <cite>inner_key</cite> from this dict; for example,</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">get_attr</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="s2">&quot;criterion&quot;</span><span class="p">,</span> <span class="s2">&quot;bce&quot;</span><span class="p">)</span>
<span class="c1"># is equivalent to</span>
<span class="n">runner</span><span class="o">.</span><span class="n">criterion</span><span class="p">[</span><span class="s2">&quot;bce&quot;</span><span class="p">]</span>

<span class="n">get_attr</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="s2">&quot;optimizer&quot;</span><span class="p">,</span> <span class="s2">&quot;adam&quot;</span><span class="p">)</span>
<span class="c1"># is equivalent to</span>
<span class="n">runner</span><span class="o">.</span><span class="n">optimizer</span><span class="p">[</span><span class="s2">&quot;adam&quot;</span><span class="p">]</span>

<span class="n">get_attr</span><span class="p">(</span><span class="n">runner</span><span class="p">,</span> <span class="s2">&quot;scheduler&quot;</span><span class="p">,</span> <span class="s2">&quot;adam&quot;</span><span class="p">)</span>
<span class="c1"># is equivalent to</span>
<span class="n">runner</span><span class="o">.</span><span class="n">scheduler</span><span class="p">[</span><span class="s2">&quot;adam&quot;</span><span class="p">]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>obj</strong> – object of interest</p></li>
<li><p><strong>key</strong> – name for attribute of interest,
like <cite>criterion</cite>, <cite>optimizer</cite>, <cite>scheduler</cite></p></li>
<li><p><strong>inner_key</strong> – name of inner dictionary key</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>inner attribute</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.misc.set_global_seed">
<code class="sig-prename descclassname">catalyst.utils.misc.</code><code class="sig-name descname">set_global_seed</code><span class="sig-paren">(</span><em class="sig-param">seed: int</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/utils/misc.html#set_global_seed"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.misc.set_global_seed" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets random seed into Numpy and Random, PyTorch and TensorFlow.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed</strong> – random seed</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.misc.get_dictkey_auto_fn">
<code class="sig-prename descclassname">catalyst.utils.misc.</code><code class="sig-name descname">get_dictkey_auto_fn</code><span class="sig-paren">(</span><em class="sig-param">key: Union[str, List[str], None]</em><span class="sig-paren">)</span> &#x2192; Callable<a class="reference internal" href="../_modules/catalyst/utils/misc.html#get_dictkey_auto_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.misc.get_dictkey_auto_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Function generator for sub-dict preparation from dict
based on predefined keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>key</strong> – keys</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>function</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – if key is out of
    <cite>str</cite>, <cite>tuple</cite>, <cite>list</cite>, <cite>dict</cite>, <cite>None</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.misc.merge_dicts">
<code class="sig-prename descclassname">catalyst.utils.misc.</code><code class="sig-name descname">merge_dicts</code><span class="sig-paren">(</span><em class="sig-param">*dicts: dict</em><span class="sig-paren">)</span> &#x2192; dict<a class="reference internal" href="../_modules/catalyst/utils/misc.html#merge_dicts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.misc.merge_dicts" title="Permalink to this definition">¶</a></dt>
<dd><p>Recursive dict merge.
Instead of updating only top-level keys,
<code class="docutils literal notranslate"><span class="pre">merge_dicts</span></code> recurses down into dicts nested
to an arbitrary depth, updating keys.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*dicts</strong> – several dictionaries to merge</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>deep-merged dictionary</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.misc.flatten_dict">
<code class="sig-prename descclassname">catalyst.utils.misc.</code><code class="sig-name descname">flatten_dict</code><span class="sig-paren">(</span><em class="sig-param">dictionary: Dict[str, Any], parent_key: str = '', separator: str = '/'</em><span class="sig-paren">)</span> &#x2192; collections.OrderedDict<a class="reference internal" href="../_modules/catalyst/utils/misc.html#flatten_dict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.misc.flatten_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Make the given dictionary flatten.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dictionary</strong> – giving dictionary</p></li>
<li><p><strong>parent_key</strong> (<em>str</em><em>, </em><em>optional</em>) – prefix nested keys with
string <code class="docutils literal notranslate"><span class="pre">parent_key</span></code></p></li>
<li><p><strong>separator</strong> (<em>str</em><em>, </em><em>optional</em>) – delimiter between
<code class="docutils literal notranslate"><span class="pre">parent_key</span></code> and <code class="docutils literal notranslate"><span class="pre">key</span></code> to use</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>ordered dictionary with flatten keys</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>collections.OrderedDict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.misc.split_dict_to_subdicts">
<code class="sig-prename descclassname">catalyst.utils.misc.</code><code class="sig-name descname">split_dict_to_subdicts</code><span class="sig-paren">(</span><em class="sig-param">dct: Dict</em>, <em class="sig-param">prefixes: List</em>, <em class="sig-param">extra_key: str</em><span class="sig-paren">)</span> &#x2192; Dict<a class="reference internal" href="../_modules/catalyst/utils/misc.html#split_dict_to_subdicts"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.misc.split_dict_to_subdicts" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits dict into subdicts with spesicied <code class="docutils literal notranslate"><span class="pre">prefixes</span></code>.
Keys, which don’t startswith one of the prefixes go to <code class="docutils literal notranslate"><span class="pre">extra_key</span></code>.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">dct</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;train_v1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;train_v2&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;not_train&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">split_dict_to_subdicts</span><span class="p">(</span><span class="n">dct</span><span class="p">,</span> <span class="n">prefixes</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;train&quot;</span><span class="p">],</span> <span class="n">extra_key</span><span class="o">=</span><span class="s2">&quot;_extra&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">{</span><span class="s2">&quot;train&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;v1&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;v2&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span> <span class="s2">&quot;_extra&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;not_train&quot;</span><span class="p">:</span> <span class="mi">3</span><span class="p">}}</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dct</strong> – dictionary with keys with prefixes</p></li>
<li><p><strong>prefixes</strong> – prefixes of interest, which we would like to reveal</p></li>
<li><p><strong>extra_key</strong> – extra key to store everything else</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dictionary with subdictionaries with
<code class="docutils literal notranslate"><span class="pre">prefixes</span></code> and <code class="docutils literal notranslate"><span class="pre">extra_key</span></code> keys</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.misc.get_hash">
<code class="sig-prename descclassname">catalyst.utils.misc.</code><code class="sig-name descname">get_hash</code><span class="sig-paren">(</span><em class="sig-param">obj: Any</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="../_modules/catalyst/utils/misc.html#get_hash"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.misc.get_hash" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates unique hash from object following way:
- Represent obj as sting recursively
- Hash this string with sha256 hash function
- encode hash with url-safe base64 encoding</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obj</strong> – object to hash</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>base64-encoded string</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.misc.get_short_hash">
<code class="sig-prename descclassname">catalyst.utils.misc.</code><code class="sig-name descname">get_short_hash</code><span class="sig-paren">(</span><em class="sig-param">obj</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="../_modules/catalyst/utils/misc.html#get_short_hash"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.misc.get_short_hash" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates unique short hash from object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>obj</strong> – object to hash</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>short base64-encoded string (6 chars)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.misc.args_are_not_none">
<code class="sig-prename descclassname">catalyst.utils.misc.</code><code class="sig-name descname">args_are_not_none</code><span class="sig-paren">(</span><em class="sig-param">*args: Optional[Any]</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="../_modules/catalyst/utils/misc.html#args_are_not_none"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.misc.args_are_not_none" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that all arguments are not <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> – values  # noqa: RST213</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if all value were not None, False otherwise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.misc.make_tuple">
<code class="sig-prename descclassname">catalyst.utils.misc.</code><code class="sig-name descname">make_tuple</code><span class="sig-paren">(</span><em class="sig-param">tuple_like</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/misc.html#make_tuple"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.misc.make_tuple" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a tuple if given <code class="docutils literal notranslate"><span class="pre">tuple_like</span></code> value isn’t list or tuple.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tuple_like</strong> – tuple like object - list or tuple</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple or list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.misc.pairwise">
<code class="sig-prename descclassname">catalyst.utils.misc.</code><code class="sig-name descname">pairwise</code><span class="sig-paren">(</span><em class="sig-param">iterable: Iterable[Any]</em><span class="sig-paren">)</span> &#x2192; Iterable[Any]<a class="reference internal" href="../_modules/catalyst/utils/misc.html#pairwise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.misc.pairwise" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterate sequences by pairs.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">pairwise</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="o">-</span><span class="mi">3</span><span class="p">]):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
<span class="go">(1, 2)</span>
<span class="go">(2, 5)</span>
<span class="go">(5, -3)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>iterable</strong> – Any iterable sequence</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>pairwise iterator</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.misc.find_value_ids">
<code class="sig-prename descclassname">catalyst.utils.misc.</code><code class="sig-name descname">find_value_ids</code><span class="sig-paren">(</span><em class="sig-param">it: Iterable[Any], value: Any</em><span class="sig-paren">)</span> &#x2192; List[int]<a class="reference internal" href="../_modules/catalyst/utils/misc.html#find_value_ids"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.misc.find_value_ids" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>it</strong> – list of any</p></li>
<li><p><strong>value</strong> – query element</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>indices of the all elements equal x0</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-catalyst.utils.numpy">
<span id="numpy"></span><h3><a class="toc-backref" href="#id9">Numpy</a><a class="headerlink" href="#module-catalyst.utils.numpy" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.utils.numpy.get_one_hot">
<code class="sig-prename descclassname">catalyst.utils.numpy.</code><code class="sig-name descname">get_one_hot</code><span class="sig-paren">(</span><em class="sig-param">label: int</em>, <em class="sig-param">num_classes: int</em>, <em class="sig-param">smoothing: float = None</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/catalyst/utils/numpy.html#get_one_hot"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.numpy.get_one_hot" title="Permalink to this definition">¶</a></dt>
<dd><p>Applies OneHot vectorization to a giving scalar, optional with
label smoothing as described in <a class="reference external" href="https://arxiv.org/abs/1812.01187">Bag of Tricks for Image Classification
with Convolutional Neural Networks</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> – scalar value to be vectorized</p></li>
<li><p><strong>num_classes</strong> – total number of classes</p></li>
<li><p><strong>smoothing</strong> (<em>float</em><em>, </em><em>optional</em>) – if specified applies label smoothing
from <code class="docutils literal notranslate"><span class="pre">Bag</span> <span class="pre">of</span> <span class="pre">Tricks</span> <span class="pre">for</span> <span class="pre">Image</span> <span class="pre">Classification</span>
<span class="pre">with</span> <span class="pre">Convolutional</span> <span class="pre">Neural</span> <span class="pre">Networks</span></code> paper</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>a one-hot vector with shape <code class="docutils literal notranslate"><span class="pre">(num_classes,)</span></code></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-catalyst.utils.parser">
<span id="parser"></span><h3><a class="toc-backref" href="#id10">Parser</a><a class="headerlink" href="#module-catalyst.utils.parser" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.utils.parser.parse_config_args">
<code class="sig-prename descclassname">catalyst.utils.parser.</code><code class="sig-name descname">parse_config_args</code><span class="sig-paren">(</span><em class="sig-param">*</em>, <em class="sig-param">config</em>, <em class="sig-param">args</em>, <em class="sig-param">unknown_args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/parser.html#parse_config_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.parser.parse_config_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Parse config and cli args.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> – dict-based experiment config</p></li>
<li><p><strong>args</strong> – cli args</p></li>
<li><p><strong>unknown_args</strong> – cli unknown args</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>final experiment config and cli args</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>config, args</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.parser.parse_args_uargs">
<code class="sig-prename descclassname">catalyst.utils.parser.</code><code class="sig-name descname">parse_args_uargs</code><span class="sig-paren">(</span><em class="sig-param">args</em>, <em class="sig-param">unknown_args</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/parser.html#parse_args_uargs"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.parser.parse_args_uargs" title="Permalink to this definition">¶</a></dt>
<dd><p>Function for parsing configuration files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>args</strong> – recognized arguments</p></li>
<li><p><strong>unknown_args</strong> – unrecognized arguments</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>updated arguments, dict with config</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-catalyst.utils.pruning">
<span id="pruning"></span><h3><a class="toc-backref" href="#id11">Pruning</a><a class="headerlink" href="#module-catalyst.utils.pruning" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.utils.pruning.prune_model">
<code class="sig-prename descclassname">catalyst.utils.pruning.</code><code class="sig-name descname">prune_model</code><span class="sig-paren">(</span><em class="sig-param">model: torch.nn.modules.module.Module, pruning_fn: Callable, keys_to_prune: List[str], amount: Union[float, int], layers_to_prune: Optional[List[str]] = None, reinitialize_after_pruning: Optional[bool] = False</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/utils/pruning.html#prune_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.pruning.prune_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Prune model function can be used for pruning certain
tensors in model layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>AttributeError</strong> – If layers_to_prune is not None, but there is
    no layers with specified name.</p></li>
<li><p><strong>Exception</strong> – If no layers have specified keys.</p></li>
</ul>
</dd>
<dt class="field-even">Parameters</dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>model</strong> – Model to be pruned.</p></li>
<li><p><strong>pruning_fn</strong> – Pruning function with API same as in
torch.nn.utils.pruning.
pruning_fn(module, name, amount).</p></li>
<li><p><strong>keys_to_prune</strong> – list of strings. Determines
which tensor in modules will be pruned.</p></li>
<li><p><strong>amount</strong> – quantity of parameters to prune.
If float, should be between 0.0 and 1.0 and
represent the fraction of parameters to prune.
If int, it represents the absolute number
of parameters to prune.</p></li>
<li><p><strong>layers_to_prune</strong> – list of strings - module names to be pruned.
If None provided then will try to prune every module in
model.</p></li>
<li><p><strong>reinitialize_after_pruning</strong> – if True then will reinitialize model
after pruning. (Lottery Ticket Hypothesis check e.g.)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.pruning.remove_reparametrization">
<code class="sig-prename descclassname">catalyst.utils.pruning.</code><code class="sig-name descname">remove_reparametrization</code><span class="sig-paren">(</span><em class="sig-param">model: torch.nn.modules.module.Module, keys_to_prune: List[str], layers_to_prune: Optional[List[str]] = None</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/utils/pruning.html#remove_reparametrization"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.pruning.remove_reparametrization" title="Permalink to this definition">¶</a></dt>
<dd><p>Removes pre-hooks and pruning masks from the model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – model to remove reparametrization.</p></li>
<li><p><strong>keys_to_prune</strong> – list of strings. Determines
which tensor in modules have already been pruned.</p></li>
<li><p><strong>layers_to_prune</strong> – list of strings - module names
have already been pruned.
If None provided then will try to prune every module in
model.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-catalyst.utils.quantization">
<span id="quantization"></span><h3><a class="toc-backref" href="#id12">Quantization</a><a class="headerlink" href="#module-catalyst.utils.quantization" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.utils.quantization.quantize_model_from_checkpoint">
<code class="sig-prename descclassname">catalyst.utils.quantization.</code><code class="sig-name descname">quantize_model_from_checkpoint</code><span class="sig-paren">(</span><em class="sig-param">logdir: pathlib.Path</em>, <em class="sig-param">checkpoint_name: str</em>, <em class="sig-param">stage: str = None</em>, <em class="sig-param">qconfig_spec: Union[Set</em>, <em class="sig-param">Dict</em>, <em class="sig-param">None] = None</em>, <em class="sig-param">dtype: Optional[torch.dtype] = torch.qint8</em>, <em class="sig-param">backend: str = None</em><span class="sig-paren">)</span> &#x2192; torch.nn.modules.module.Module<a class="reference internal" href="../_modules/catalyst/utils/quantization.html#quantize_model_from_checkpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.quantization.quantize_model_from_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Quantize model using created experiment and runner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logdir</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) – Path to Catalyst logdir with model</p></li>
<li><p><strong>checkpoint_name</strong> – Name of model checkpoint to use</p></li>
<li><p><strong>stage</strong> – experiment’s stage name</p></li>
<li><p><strong>qconfig_spec</strong> – torch.quantization.quantize_dynamic
parameter, you can define layers to be quantize</p></li>
<li><p><strong>dtype</strong> – type of the model parameters, default int8</p></li>
<li><p><strong>backend</strong> – defines backend for quantization</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Quantized model</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.quantization.save_quantized_model">
<code class="sig-prename descclassname">catalyst.utils.quantization.</code><code class="sig-name descname">save_quantized_model</code><span class="sig-paren">(</span><em class="sig-param">model: torch.nn.modules.module.Module</em>, <em class="sig-param">logdir: Union[str</em>, <em class="sig-param">pathlib.Path] = None</em>, <em class="sig-param">checkpoint_name: str = None</em>, <em class="sig-param">out_dir: Union[str</em>, <em class="sig-param">pathlib.Path] = None</em>, <em class="sig-param">out_model: Union[str</em>, <em class="sig-param">pathlib.Path] = None</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/utils/quantization.html#save_quantized_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.quantization.save_quantized_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves quantized model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Traced model</p></li>
<li><p><strong>logdir</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) – Path to experiment</p></li>
<li><p><strong>checkpoint_name</strong> – name for the checkpoint</p></li>
<li><p><strong>out_dir</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) – Directory to save model to
(overrides logdir)</p></li>
<li><p><strong>out_model</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) – Path to save model to
(overrides logdir &amp; out_dir)</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if nothing out of <cite>logdir</cite>, <cite>out_dir</cite> or <cite>out_model</cite>
    is specified.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-catalyst.utils.scripts">
<span id="scripts"></span><h3><a class="toc-backref" href="#id13">Scripts</a><a class="headerlink" href="#module-catalyst.utils.scripts" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.utils.scripts.import_module">
<code class="sig-prename descclassname">catalyst.utils.scripts.</code><code class="sig-name descname">import_module</code><span class="sig-paren">(</span><em class="sig-param">expdir: Union[str, pathlib.Path]</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/scripts.html#import_module"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.scripts.import_module" title="Permalink to this definition">¶</a></dt>
<dd><p>Imports python module by path.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>expdir</strong> – path to python module.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Imported module.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.scripts.dump_code">
<code class="sig-prename descclassname">catalyst.utils.scripts.</code><code class="sig-name descname">dump_code</code><span class="sig-paren">(</span><em class="sig-param">expdir: Union[str, pathlib.Path], logdir: Union[str, pathlib.Path]</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/utils/scripts.html#dump_code"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.scripts.dump_code" title="Permalink to this definition">¶</a></dt>
<dd><p>Dumps Catalyst code for reproducibility.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expdir</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>pathlib.Path</em><em>]</em>) – experiment dir path</p></li>
<li><p><strong>logdir</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>pathlib.Path</em><em>]</em>) – logging dir path</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.scripts.dump_python_files">
<code class="sig-prename descclassname">catalyst.utils.scripts.</code><code class="sig-name descname">dump_python_files</code><span class="sig-paren">(</span><em class="sig-param">src: pathlib.Path</em>, <em class="sig-param">dst: pathlib.Path</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/utils/scripts.html#dump_python_files"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.scripts.dump_python_files" title="Permalink to this definition">¶</a></dt>
<dd><p>Dumps python code (<code class="docutils literal notranslate"><span class="pre">*.py</span></code> and <code class="docutils literal notranslate"><span class="pre">*.ipynb</span></code>) files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong> – source code path</p></li>
<li><p><strong>dst</strong> – destination code path</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.scripts.prepare_config_api_components">
<code class="sig-prename descclassname">catalyst.utils.scripts.</code><code class="sig-name descname">prepare_config_api_components</code><span class="sig-paren">(</span><em class="sig-param">expdir: pathlib.Path</em>, <em class="sig-param">config: Dict</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/scripts.html#prepare_config_api_components"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.scripts.prepare_config_api_components" title="Permalink to this definition">¶</a></dt>
<dd><p>Imports and create core Config API components - Experiment, Runner
and Config from <code class="docutils literal notranslate"><span class="pre">expdir</span></code> - experiment directory
and <code class="docutils literal notranslate"><span class="pre">config</span></code> - experiment config.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>expdir</strong> – experiment directory path</p></li>
<li><p><strong>config</strong> – dictionary with experiment Config</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Experiment, Runner, Config for Config API usage.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.scripts.dump_experiment_code">
<code class="sig-prename descclassname">catalyst.utils.scripts.</code><code class="sig-name descname">dump_experiment_code</code><span class="sig-paren">(</span><em class="sig-param">src: pathlib.Path</em>, <em class="sig-param">dst: pathlib.Path</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/utils/scripts.html#dump_experiment_code"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.scripts.dump_experiment_code" title="Permalink to this definition">¶</a></dt>
<dd><p>Dumps your experiment code for Config API use cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>src</strong> – source code path</p></li>
<li><p><strong>dst</strong> – destination code path</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.scripts.distributed_cmd_run">
<code class="sig-prename descclassname">catalyst.utils.scripts.</code><code class="sig-name descname">distributed_cmd_run</code><span class="sig-paren">(</span><em class="sig-param">worker_fn: Callable</em>, <em class="sig-param">distributed: bool = True</em>, <em class="sig-param">*args</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/utils/scripts.html#distributed_cmd_run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.scripts.distributed_cmd_run" title="Permalink to this definition">¶</a></dt>
<dd><p>Distributed run</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>worker_fn</strong> – worker fn to run in distributed mode</p></li>
<li><p><strong>distributed</strong> – distributed flag</p></li>
<li><p><strong>args</strong> – additional parameters for worker_fn</p></li>
<li><p><strong>kwargs</strong> – additional key-value parameters for worker_fn</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-catalyst.utils.swa">
<span id="stochastic-weights-averaging-swa"></span><h3><a class="toc-backref" href="#id14">Stochastic Weights Averaging (SWA)</a><a class="headerlink" href="#module-catalyst.utils.swa" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.utils.swa.average_weights">
<code class="sig-prename descclassname">catalyst.utils.swa.</code><code class="sig-name descname">average_weights</code><span class="sig-paren">(</span><em class="sig-param">state_dicts: List[dict]</em><span class="sig-paren">)</span> &#x2192; collections.OrderedDict<a class="reference internal" href="../_modules/catalyst/utils/swa.html#average_weights"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.swa.average_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Averaging of input weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state_dicts</strong> – Weights to average</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>KeyError</strong> – If states do not match</p>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Averaged weights</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.swa.get_averaged_weights_by_path_mask">
<code class="sig-prename descclassname">catalyst.utils.swa.</code><code class="sig-name descname">get_averaged_weights_by_path_mask</code><span class="sig-paren">(</span><em class="sig-param">path_mask: str</em>, <em class="sig-param">logdir: Union[str</em>, <em class="sig-param">pathlib.Path] = None</em><span class="sig-paren">)</span> &#x2192; collections.OrderedDict<a class="reference internal" href="../_modules/catalyst/utils/swa.html#get_averaged_weights_by_path_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.swa.get_averaged_weights_by_path_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Averaging of input weights and saving them.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>path_mask</strong> – globe-like pattern for models to average</p></li>
<li><p><strong>logdir</strong> – Path to logs directory</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Averaged weights</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-catalyst.utils.sys">
<span id="sys"></span><h3><a class="toc-backref" href="#id15">Sys</a><a class="headerlink" href="#module-catalyst.utils.sys" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.utils.sys.get_environment_vars">
<code class="sig-prename descclassname">catalyst.utils.sys.</code><code class="sig-name descname">get_environment_vars</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; Dict[str, Any]<a class="reference internal" href="../_modules/catalyst/utils/sys.html#get_environment_vars"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.sys.get_environment_vars" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a dictionary with environment variables.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>environment variables</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.sys.list_conda_packages">
<code class="sig-prename descclassname">catalyst.utils.sys.</code><code class="sig-name descname">list_conda_packages</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="../_modules/catalyst/utils/sys.html#list_conda_packages"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.sys.list_conda_packages" title="Permalink to this definition">¶</a></dt>
<dd><p>Lists conda installed packages.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>list with conda installed packages</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.sys.list_pip_packages">
<code class="sig-prename descclassname">catalyst.utils.sys.</code><code class="sig-name descname">list_pip_packages</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="../_modules/catalyst/utils/sys.html#list_pip_packages"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.sys.list_pip_packages" title="Permalink to this definition">¶</a></dt>
<dd><p>Lists pip installed packages.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>string with pip installed packages</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.sys.dump_environment">
<code class="sig-prename descclassname">catalyst.utils.sys.</code><code class="sig-name descname">dump_environment</code><span class="sig-paren">(</span><em class="sig-param">experiment_config: Dict</em>, <em class="sig-param">logdir: str</em>, <em class="sig-param">configs_path: List[str] = None</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/utils/sys.html#dump_environment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.sys.dump_environment" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves config, environment variables and package list in JSON into logdir.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>experiment_config</strong> – experiment config</p></li>
<li><p><strong>logdir</strong> – path to logdir</p></li>
<li><p><strong>configs_path</strong> – path(s) to config</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-catalyst.utils.torch">
<span id="torch"></span><h3><a class="toc-backref" href="#id16">Torch</a><a class="headerlink" href="#module-catalyst.utils.torch" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.utils.torch.get_optimizable_params">
<code class="sig-prename descclassname">catalyst.utils.torch.</code><code class="sig-name descname">get_optimizable_params</code><span class="sig-paren">(</span><em class="sig-param">model_or_params</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#get_optimizable_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.torch.get_optimizable_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns all the parameters that requires gradients.</p>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.torch.get_optimizer_momentum">
<code class="sig-prename descclassname">catalyst.utils.torch.</code><code class="sig-name descname">get_optimizer_momentum</code><span class="sig-paren">(</span><em class="sig-param">optimizer: torch.optim.optimizer.Optimizer</em><span class="sig-paren">)</span> &#x2192; float<a class="reference internal" href="../_modules/catalyst/utils/torch.html#get_optimizer_momentum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.torch.get_optimizer_momentum" title="Permalink to this definition">¶</a></dt>
<dd><p>Get momentum of current optimizer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>optimizer</strong> – PyTorch optimizer</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>momentum at first param group</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.torch.get_optimizer_momentum_list">
<code class="sig-prename descclassname">catalyst.utils.torch.</code><code class="sig-name descname">get_optimizer_momentum_list</code><span class="sig-paren">(</span><em class="sig-param">optimizer: torch.optim.optimizer.Optimizer</em><span class="sig-paren">)</span> &#x2192; List[Optional[float]]<a class="reference internal" href="../_modules/catalyst/utils/torch.html#get_optimizer_momentum_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.torch.get_optimizer_momentum_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Get list of optimizer momentums (for each param group)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>optimizer</strong> – PyTorch optimizer</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>momentum for each param group</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>momentum_list (List[Union[float, None]])</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.torch.set_optimizer_momentum">
<code class="sig-prename descclassname">catalyst.utils.torch.</code><code class="sig-name descname">set_optimizer_momentum</code><span class="sig-paren">(</span><em class="sig-param">optimizer: torch.optim.optimizer.Optimizer</em>, <em class="sig-param">value: float</em>, <em class="sig-param">index: int = 0</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#set_optimizer_momentum"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.torch.set_optimizer_momentum" title="Permalink to this definition">¶</a></dt>
<dd><p>Set momentum of <code class="docutils literal notranslate"><span class="pre">index</span></code> ‘th param group of optimizer to <code class="docutils literal notranslate"><span class="pre">value</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>optimizer</strong> – PyTorch optimizer</p></li>
<li><p><strong>value</strong> – new value of momentum</p></li>
<li><p><strong>index</strong> (<em>int</em><em>, </em><em>optional</em>) – integer index of optimizer’s param groups,
default is 0</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.torch.get_device">
<code class="sig-prename descclassname">catalyst.utils.torch.</code><code class="sig-name descname">get_device</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; torch.device<a class="reference internal" href="../_modules/catalyst/utils/torch.html#get_device"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.torch.get_device" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple returning the best available device (TPU &gt; GPU &gt; CPU).</p>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.torch.get_available_gpus">
<code class="sig-prename descclassname">catalyst.utils.torch.</code><code class="sig-name descname">get_available_gpus</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#get_available_gpus"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.torch.get_available_gpus" title="Permalink to this definition">¶</a></dt>
<dd><p>Array of available GPU ids.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_VISIBLE_DEVICES&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;0,2&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_available_gpus</span><span class="p">()</span>
<span class="go">[0, 2]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_VISIBLE_DEVICES&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;0,-1,1&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_available_gpus</span><span class="p">()</span>
<span class="go">[0]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_VISIBLE_DEVICES&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_available_gpus</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s2">&quot;CUDA_VISIBLE_DEVICES&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;-1&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_available_gpus</span><span class="p">()</span>
<span class="go">[]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>available GPU ids</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>iterable</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.torch.get_activation_fn">
<code class="sig-prename descclassname">catalyst.utils.torch.</code><code class="sig-name descname">get_activation_fn</code><span class="sig-paren">(</span><em class="sig-param">activation: str = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#get_activation_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.torch.get_activation_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the activation function from <code class="docutils literal notranslate"><span class="pre">torch.nn</span></code> by its name.</p>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.torch.any2device">
<code class="sig-prename descclassname">catalyst.utils.torch.</code><code class="sig-name descname">any2device</code><span class="sig-paren">(</span><em class="sig-param">value, device: Union[str, torch.device]</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#any2device"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.torch.any2device" title="Permalink to this definition">¶</a></dt>
<dd><p>Move tensor, list of tensors, list of list of tensors,
dict of tensors, tuple of tensors to target device.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>value</strong> – Object to be moved</p></li>
<li><p><strong>device</strong> – target device ids</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Same structure as value, but all tensors and np.arrays moved to device</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.torch.prepare_cudnn">
<code class="sig-prename descclassname">catalyst.utils.torch.</code><code class="sig-name descname">prepare_cudnn</code><span class="sig-paren">(</span><em class="sig-param">deterministic: bool = None</em>, <em class="sig-param">benchmark: bool = None</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/utils/torch.html#prepare_cudnn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.torch.prepare_cudnn" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares CuDNN benchmark and sets CuDNN
to be deterministic/non-deterministic mode</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>deterministic</strong> – deterministic mode if running in CuDNN backend.</p></li>
<li><p><strong>benchmark</strong> – If <code class="docutils literal notranslate"><span class="pre">True</span></code> use CuDNN heuristics to figure out
which algorithm will be most performant
for your model architecture and input.
Setting it to <code class="docutils literal notranslate"><span class="pre">False</span></code> may slow down your training.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.torch.process_model_params">
<code class="sig-prename descclassname">catalyst.utils.torch.</code><code class="sig-name descname">process_model_params</code><span class="sig-paren">(</span><em class="sig-param">model: torch.nn.modules.module.Module</em>, <em class="sig-param">layerwise_params: Dict[str</em>, <em class="sig-param">dict] = None</em>, <em class="sig-param">no_bias_weight_decay: bool = True</em>, <em class="sig-param">lr_scaling: float = 1.0</em><span class="sig-paren">)</span> &#x2192; List[Union[torch.nn.parameter.Parameter, dict]]<a class="reference internal" href="../_modules/catalyst/utils/torch.html#process_model_params"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.torch.process_model_params" title="Permalink to this definition">¶</a></dt>
<dd><p>Gains model parameters for <code class="docutils literal notranslate"><span class="pre">torch.optim.Optimizer</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Model to process</p></li>
<li><p><strong>layerwise_params</strong> – Order-sensitive dict where
each key is regex pattern and values are layer-wise options
for layers matching with a pattern</p></li>
<li><p><strong>no_bias_weight_decay</strong> – If true, removes weight_decay
for all <code class="docutils literal notranslate"><span class="pre">bias</span></code> parameters in the model</p></li>
<li><p><strong>lr_scaling</strong> – layer-wise learning rate scaling,
if 1.0, learning rates will not be scaled</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>parameters for an optimizer</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>iterable</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">catalyst</span><span class="o">.</span><span class="n">contrib</span><span class="o">.</span><span class="n">models</span><span class="o">.</span><span class="n">segmentation</span><span class="o">.</span><span class="n">ResnetUnet</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layerwise_params</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">([</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s2">&quot;conv1.*&quot;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.001</span><span class="p">,</span> <span class="n">weight_decay</span><span class="o">=</span><span class="mf">0.0003</span><span class="p">)),</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="p">(</span><span class="s2">&quot;conv.*&quot;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">(</span><span class="n">lr</span><span class="o">=</span><span class="mf">0.002</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">params</span> <span class="o">=</span> <span class="n">process_model_params</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">layerwise_params</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">optimizer</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">params</span><span class="p">,</span> <span class="n">lr</span><span class="o">=</span><span class="mf">0.0003</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.torch.get_requires_grad">
<code class="sig-prename descclassname">catalyst.utils.torch.</code><code class="sig-name descname">get_requires_grad</code><span class="sig-paren">(</span><em class="sig-param">model: torch.nn.modules.module.Module</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#get_requires_grad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.torch.get_requires_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the <code class="docutils literal notranslate"><span class="pre">requires_grad</span></code> value for all model parameters.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SimpleModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">requires_grad</span> <span class="o">=</span> <span class="n">get_requires_grad</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>model</strong> – model</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>value</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>requires_grad (Dict[str, bool])</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.torch.set_requires_grad">
<code class="sig-prename descclassname">catalyst.utils.torch.</code><code class="sig-name descname">set_requires_grad</code><span class="sig-paren">(</span><em class="sig-param">model: torch.nn.modules.module.Module, requires_grad: Union[bool, Dict[str, bool]]</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#set_requires_grad"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.torch.set_requires_grad" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets the <code class="docutils literal notranslate"><span class="pre">requires_grad</span></code> value for all model parameters.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SimpleModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">set_requires_grad</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># or</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SimpleModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">set_requires_grad</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">requires_grad</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;&quot;</span><span class="p">})</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – model</p></li>
<li><p><strong>requires_grad</strong> (<em>Union</em><em>[</em><em>bool</em><em>, </em><em>Dict</em><em>[</em><em>str</em><em>, </em><em>bool</em><em>]</em><em>]</em>) – value</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.torch.get_network_output">
<code class="sig-prename descclassname">catalyst.utils.torch.</code><code class="sig-name descname">get_network_output</code><span class="sig-paren">(</span><em class="sig-param">net: torch.nn.modules.module.Module</em>, <em class="sig-param">*input_shapes_args</em>, <em class="sig-param">**input_shapes_kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#get_network_output"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.torch.get_network_output" title="Permalink to this definition">¶</a></dt>
<dd><p># noqa: D202
For each input shape returns an output tensor</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">utils</span><span class="o">.</span><span class="n">get_network_output</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="go">tensor([[[-0.2665,  0.5792,  0.9757, -0.5782,  0.1530]]])</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>net</strong> – the model</p></li>
<li><p><strong>*input_shapes_args</strong> – variable length argument list of shapes</p></li>
<li><p><strong>**input_shapes_kwargs</strong> – key-value arguemnts of shapes</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tensor with network output</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.torch.detach">
<code class="sig-prename descclassname">catalyst.utils.torch.</code><code class="sig-name descname">detach</code><span class="sig-paren">(</span><em class="sig-param">tensor: torch.Tensor</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/catalyst/utils/torch.html#detach"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.torch.detach" title="Permalink to this definition">¶</a></dt>
<dd><p>Detach a pytorch tensor from graph and
convert it to numpy array</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tensor</strong> – PyTorch tensor</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>numpy ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.torch.trim_tensors">
<code class="sig-prename descclassname">catalyst.utils.torch.</code><code class="sig-name descname">trim_tensors</code><span class="sig-paren">(</span><em class="sig-param">tensors</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#trim_tensors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.torch.trim_tensors" title="Permalink to this definition">¶</a></dt>
<dd><p>Trim padding off of a batch of tensors to the smallest possible length.
Should be used with <cite>catalyst.data.DynamicLenBatchSampler</cite>.</p>
<p>Adapted from <a class="reference external" href="https://www.kaggle.com/c/jigsaw-unintended-bias-in-toxicity-classification/discussion/94779">Dynamic minibatch trimming to improve BERT training speed</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>tensors</strong> – list of tensors to trim.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of trimmed tensors.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[torch.tensor]</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.torch.normalize">
<code class="sig-prename descclassname">catalyst.utils.torch.</code><code class="sig-name descname">normalize</code><span class="sig-paren">(</span><em class="sig-param">samples: torch.Tensor</em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/catalyst/utils/torch.html#normalize"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.torch.normalize" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>samples</strong> – tensor with shape of [n_samples, features_dim]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>normalized tensor with the same shape</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.torch.convert_labels2list">
<code class="sig-prename descclassname">catalyst.utils.torch.</code><code class="sig-name descname">convert_labels2list</code><span class="sig-paren">(</span><em class="sig-param">labels: Union[torch.Tensor, List[int]]</em><span class="sig-paren">)</span> &#x2192; List[int]<a class="reference internal" href="../_modules/catalyst/utils/torch.html#convert_labels2list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.torch.convert_labels2list" title="Permalink to this definition">¶</a></dt>
<dd><p>This function allows to work with 2 types of indexing:
using a integer tensor and a list of indices.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>labels</strong> – labels of batch samples</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>labels of batch samples in the aligned format</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>TypeError</strong> – if type of input labels is not tensor and list</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.torch.get_optimal_inner_init">
<code class="sig-prename descclassname">catalyst.utils.torch.</code><code class="sig-name descname">get_optimal_inner_init</code><span class="sig-paren">(</span><em class="sig-param">nonlinearity: torch.nn.modules.module.Module</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; Callable[torch.nn.modules.module.Module, None]<a class="reference internal" href="../_modules/catalyst/utils/torch.html#get_optimal_inner_init"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.torch.get_optimal_inner_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Create initializer for inner layers
based on their activation function (nonlinearity).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nonlinearity</strong> – non-linear activation</p></li>
<li><p><strong>**kwargs</strong> – extra kwargs</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>optimal initialization function</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><strong>NotImplementedError</strong> – if nonlinearity is out of
    <cite>sigmoid</cite>, <cite>tanh</cite>, <cite>relu, `leaky_relu</cite></p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.torch.outer_init">
<code class="sig-prename descclassname">catalyst.utils.torch.</code><code class="sig-name descname">outer_init</code><span class="sig-paren">(</span><em class="sig-param">layer: torch.nn.modules.module.Module</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/utils/torch.html#outer_init"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.torch.outer_init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialization for output layers of policy and value networks typically
used in deep reinforcement learning literature.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>layer</strong> – torch nn.Module instance</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.torch.reset_weights_if_possible">
<code class="sig-prename descclassname">catalyst.utils.torch.</code><code class="sig-name descname">reset_weights_if_possible</code><span class="sig-paren">(</span><em class="sig-param">module: torch.nn.modules.module.Module</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/torch.html#reset_weights_if_possible"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.torch.reset_weights_if_possible" title="Permalink to this definition">¶</a></dt>
<dd><p>Resets module parameters if possible.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>module</strong> – Module to reset.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-catalyst.utils.tracing">
<span id="tracing"></span><h3><a class="toc-backref" href="#id17">Tracing</a><a class="headerlink" href="#module-catalyst.utils.tracing" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.utils.tracing.trace_model">
<code class="sig-prename descclassname">catalyst.utils.tracing.</code><code class="sig-name descname">trace_model</code><span class="sig-paren">(</span><em class="sig-param">model: torch.nn.modules.module.Module</em>, <em class="sig-param">predict_fn: Callable</em>, <em class="sig-param">batch=None</em>, <em class="sig-param">method_name: str = 'forward'</em>, <em class="sig-param">mode: str = 'eval'</em>, <em class="sig-param">requires_grad: bool = False</em>, <em class="sig-param">opt_level: str = None</em>, <em class="sig-param">device: Union[str</em>, <em class="sig-param">torch.device] = 'cpu'</em>, <em class="sig-param">predict_params: dict = None</em><span class="sig-paren">)</span> &#x2192; torch.jit._script.ScriptModule<a class="reference internal" href="../_modules/catalyst/utils/tracing.html#trace_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.tracing.trace_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Traces model using runner and batch.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Model to trace</p></li>
<li><p><strong>predict_fn</strong> – Function to run prediction with the model provided,
takes model, inputs parameters</p></li>
<li><p><strong>batch</strong> – Batch to trace the model</p></li>
<li><p><strong>method_name</strong> – Model’s method name that will be
used as entrypoint during tracing</p></li>
<li><p><strong>mode</strong> – Mode for model to trace (<code class="docutils literal notranslate"><span class="pre">train</span></code> or <code class="docutils literal notranslate"><span class="pre">eval</span></code>)</p></li>
<li><p><strong>requires_grad</strong> – Flag to use grads</p></li>
<li><p><strong>opt_level</strong> – Apex FP16 init level, optional</p></li>
<li><p><strong>device</strong> – Torch device</p></li>
<li><p><strong>predict_params</strong> – additional parameters for model forward</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Traced model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>jit.ScriptModule</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if both batch and predict_fn must be specified or
    mode is not in ‘eval’ or ‘train’.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.tracing.trace_model_from_checkpoint">
<code class="sig-prename descclassname">catalyst.utils.tracing.</code><code class="sig-name descname">trace_model_from_checkpoint</code><span class="sig-paren">(</span><em class="sig-param">logdir: pathlib.Path</em>, <em class="sig-param">method_name: str</em>, <em class="sig-param">checkpoint_name: str</em>, <em class="sig-param">stage: str = None</em>, <em class="sig-param">loader: Union[str</em>, <em class="sig-param">int] = None</em>, <em class="sig-param">mode: str = 'eval'</em>, <em class="sig-param">requires_grad: bool = False</em>, <em class="sig-param">opt_level: str = None</em>, <em class="sig-param">device: Union[str</em>, <em class="sig-param">torch.device] = 'cpu'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/utils/tracing.html#trace_model_from_checkpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.tracing.trace_model_from_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Traces model using created experiment and runner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logdir</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) – Path to Catalyst logdir with model</p></li>
<li><p><strong>checkpoint_name</strong> – Name of model checkpoint to use</p></li>
<li><p><strong>stage</strong> – experiment’s stage name</p></li>
<li><p><strong>loader</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em>) – experiment’s loader name or its index</p></li>
<li><p><strong>method_name</strong> – Model’s method name that will be
used as entrypoint during tracing</p></li>
<li><p><strong>mode</strong> – Mode for model to trace (<code class="docutils literal notranslate"><span class="pre">train</span></code> or <code class="docutils literal notranslate"><span class="pre">eval</span></code>)</p></li>
<li><p><strong>requires_grad</strong> – Flag to use grads</p></li>
<li><p><strong>opt_level</strong> – AMP FP16 init level</p></li>
<li><p><strong>device</strong> – Torch device</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>the traced model</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.tracing.trace_model_from_runner">
<code class="sig-prename descclassname">catalyst.utils.tracing.</code><code class="sig-name descname">trace_model_from_runner</code><span class="sig-paren">(</span><em class="sig-param">runner: IRunner</em>, <em class="sig-param">checkpoint_name: str = None</em>, <em class="sig-param">method_name: str = 'forward'</em>, <em class="sig-param">mode: str = 'eval'</em>, <em class="sig-param">requires_grad: bool = False</em>, <em class="sig-param">opt_level: str = None</em>, <em class="sig-param">device: Union[str</em>, <em class="sig-param">torch.device] = 'cpu'</em><span class="sig-paren">)</span> &#x2192; torch.jit._script.ScriptModule<a class="reference internal" href="../_modules/catalyst/utils/tracing.html#trace_model_from_runner"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.tracing.trace_model_from_runner" title="Permalink to this definition">¶</a></dt>
<dd><p>Traces model using created experiment and runner.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>runner</strong> – current runner.</p></li>
<li><p><strong>checkpoint_name</strong> – Name of model checkpoint to use, if None
traces current model from runner</p></li>
<li><p><strong>method_name</strong> – Model’s method name that will be
used as entrypoint during tracing</p></li>
<li><p><strong>mode</strong> – Mode for model to trace (<code class="docutils literal notranslate"><span class="pre">train</span></code> or <code class="docutils literal notranslate"><span class="pre">eval</span></code>)</p></li>
<li><p><strong>requires_grad</strong> – Flag to use grads</p></li>
<li><p><strong>opt_level</strong> – AMP FP16 init level</p></li>
<li><p><strong>device</strong> – Torch device</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Traced model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ScriptModule</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.tracing.get_trace_name">
<code class="sig-prename descclassname">catalyst.utils.tracing.</code><code class="sig-name descname">get_trace_name</code><span class="sig-paren">(</span><em class="sig-param">method_name: str</em>, <em class="sig-param">mode: str = 'eval'</em>, <em class="sig-param">requires_grad: bool = False</em>, <em class="sig-param">opt_level: str = None</em>, <em class="sig-param">additional_string: str = None</em><span class="sig-paren">)</span> &#x2192; str<a class="reference internal" href="../_modules/catalyst/utils/tracing.html#get_trace_name"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.tracing.get_trace_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates a file name for the traced model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>method_name</strong> – model’s method name</p></li>
<li><p><strong>mode</strong> – <code class="docutils literal notranslate"><span class="pre">train</span></code> or <code class="docutils literal notranslate"><span class="pre">eval</span></code></p></li>
<li><p><strong>requires_grad</strong> – flag if model was traced with gradients</p></li>
<li><p><strong>opt_level</strong> – opt_level if model was traced in FP16</p></li>
<li><p><strong>additional_string</strong> – any additional information</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Filename for traced model to be saved.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>str</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.tracing.save_traced_model">
<code class="sig-prename descclassname">catalyst.utils.tracing.</code><code class="sig-name descname">save_traced_model</code><span class="sig-paren">(</span><em class="sig-param">model: torch.jit._script.ScriptModule</em>, <em class="sig-param">logdir: Union[str</em>, <em class="sig-param">pathlib.Path] = None</em>, <em class="sig-param">method_name: str = 'forward'</em>, <em class="sig-param">mode: str = 'eval'</em>, <em class="sig-param">requires_grad: bool = False</em>, <em class="sig-param">opt_level: str = None</em>, <em class="sig-param">out_dir: Union[str</em>, <em class="sig-param">pathlib.Path] = None</em>, <em class="sig-param">out_model: Union[str</em>, <em class="sig-param">pathlib.Path] = None</em>, <em class="sig-param">checkpoint_name: str = None</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/utils/tracing.html#save_traced_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.tracing.save_traced_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves traced model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> – Traced model</p></li>
<li><p><strong>logdir</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) – Path to experiment</p></li>
<li><p><strong>method_name</strong> – Name of the method was traced</p></li>
<li><p><strong>mode</strong> – Model’s mode - <cite>train</cite> or <cite>eval</cite></p></li>
<li><p><strong>requires_grad</strong> – Whether model was traced with require_grad or not</p></li>
<li><p><strong>opt_level</strong> – Apex FP16 init level used during tracing</p></li>
<li><p><strong>out_dir</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) – Directory to save model to
(overrides logdir)</p></li>
<li><p><strong>out_model</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>Path</em><em>]</em>) – Path to save model to
(overrides logdir &amp; out_dir)</p></li>
<li><p><strong>checkpoint_name</strong> – Checkpoint name used to restore the model</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if nothing out of <cite>logdir</cite>, <cite>out_dir</cite> or <cite>out_model</cite>
    is specified.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.utils.tracing.load_traced_model">
<code class="sig-prename descclassname">catalyst.utils.tracing.</code><code class="sig-name descname">load_traced_model</code><span class="sig-paren">(</span><em class="sig-param">model_path: Union[str, pathlib.Path], device: Union[str, torch.device] = 'cpu', opt_level: str = None</em><span class="sig-paren">)</span> &#x2192; torch.jit._script.ScriptModule<a class="reference internal" href="../_modules/catalyst/utils/tracing.html#load_traced_model"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.utils.tracing.load_traced_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads a traced model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model_path</strong> – Path to traced model</p></li>
<li><p><strong>device</strong> – Torch device</p></li>
<li><p><strong>opt_level</strong> – Apex FP16 init level, optional</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Traced model</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ScriptModule</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-catalyst.contrib.utils">
<span id="contrib"></span><h2><a class="toc-backref" href="#id18">Contrib</a><a class="headerlink" href="#module-catalyst.contrib.utils" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-catalyst.contrib.utils.compression">
<span id="compression"></span><h3><a class="toc-backref" href="#id19">Compression</a><a class="headerlink" href="#module-catalyst.contrib.utils.compression" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.contrib.utils.compression.pack">
<code class="sig-prename descclassname">catalyst.contrib.utils.compression.</code><code class="sig-name descname">pack</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="headerlink" href="#catalyst.contrib.utils.compression.pack" title="Permalink to this definition">¶</a></dt>
<dd><p>Serialize the data into bytes using pickle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – a value</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns a bytes object serialized with pickle data.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.compression.pack_if_needed">
<code class="sig-prename descclassname">catalyst.contrib.utils.compression.</code><code class="sig-name descname">pack_if_needed</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="headerlink" href="#catalyst.contrib.utils.compression.pack_if_needed" title="Permalink to this definition">¶</a></dt>
<dd><p>Serialize the data into bytes using pickle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – a value</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns a bytes object serialized with pickle data.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.compression.unpack">
<code class="sig-prename descclassname">catalyst.contrib.utils.compression.</code><code class="sig-name descname">unpack</code><span class="sig-paren">(</span><em class="sig-param">bytes</em><span class="sig-paren">)</span><a class="headerlink" href="#catalyst.contrib.utils.compression.unpack" title="Permalink to this definition">¶</a></dt>
<dd><p>Deserialize bytes into an object using pickle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bytes</strong> – a bytes object containing serialized with pickle data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns a value deserialized from the bytes-like object.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.compression.unpack_if_needed">
<code class="sig-prename descclassname">catalyst.contrib.utils.compression.</code><code class="sig-name descname">unpack_if_needed</code><span class="sig-paren">(</span><em class="sig-param">bytes</em><span class="sig-paren">)</span><a class="headerlink" href="#catalyst.contrib.utils.compression.unpack_if_needed" title="Permalink to this definition">¶</a></dt>
<dd><p>Deserialize bytes into an object using pickle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bytes</strong> – a bytes object containing serialized with pickle data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns a value deserialized from the bytes-like object.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-catalyst.contrib.utils.pandas">
<span id="pandas"></span><h3><a class="toc-backref" href="#id20">Pandas</a><a class="headerlink" href="#module-catalyst.contrib.utils.pandas" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.contrib.utils.pandas.dataframe_to_list">
<code class="sig-prename descclassname">catalyst.contrib.utils.pandas.</code><code class="sig-name descname">dataframe_to_list</code><span class="sig-paren">(</span><em class="sig-param">dataframe: pandas.core.frame.DataFrame</em><span class="sig-paren">)</span> &#x2192; List[dict]<a class="reference internal" href="../_modules/catalyst/contrib/utils/pandas.html#dataframe_to_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.pandas.dataframe_to_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts dataframe to a list of rows (without indexes).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>dataframe</strong> – input dataframe</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of rows</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[dict]</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.pandas.folds_to_list">
<code class="sig-prename descclassname">catalyst.contrib.utils.pandas.</code><code class="sig-name descname">folds_to_list</code><span class="sig-paren">(</span><em class="sig-param">folds: Union[list, str, pandas.core.series.Series]</em><span class="sig-paren">)</span> &#x2192; List[int]<a class="reference internal" href="../_modules/catalyst/contrib/utils/pandas.html#folds_to_list"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.pandas.folds_to_list" title="Permalink to this definition">¶</a></dt>
<dd><p>This function formats string or either list of numbers
into a list of unique int.</p>
<p class="rubric">Examples</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">folds_to_list</span><span class="p">(</span><span class="s2">&quot;1,2,1,3,4,2,4,6&quot;</span><span class="p">)</span>
<span class="go">[1, 2, 3, 4, 6]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">folds_to_list</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="go">[1, 2, 3, 5]</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>folds</strong> (<em>Union</em><em>[</em><em>list</em><em>, </em><em>str</em><em>, </em><em>pd.Series</em><em>]</em>) – Either list of numbers or
one string with numbers separated by commas or
pandas series</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>list of unique ints</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>List[int]</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>ValueError</strong> – if value in string or array cannot be casted to int</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.pandas.split_dataframe">
<code class="sig-prename descclassname">catalyst.contrib.utils.pandas.</code><code class="sig-name descname">split_dataframe</code><span class="sig-paren">(</span><em class="sig-param">dataframe: pandas.core.frame.DataFrame, train_folds: List[int], valid_folds: Optional[List[int]] = None, infer_folds: Optional[List[int]] = None, tag2class: Optional[Dict[str, int]] = None, tag_column: str = None, class_column: str = None, seed: int = 42, n_folds: int = 5</em><span class="sig-paren">)</span> &#x2192; Tuple[pandas.core.frame.DataFrame, pandas.core.frame.DataFrame, pandas.core.frame.DataFrame, pandas.core.frame.DataFrame]<a class="reference internal" href="../_modules/catalyst/contrib/utils/pandas.html#split_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.pandas.split_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Split a Pandas DataFrame into folds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> – input dataframe</p></li>
<li><p><strong>train_folds</strong> – train folds</p></li>
<li><p><strong>valid_folds</strong> (<em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – valid folds.
If none takes all folds not included in <code class="docutils literal notranslate"><span class="pre">train_folds</span></code></p></li>
<li><p><strong>infer_folds</strong> (<em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – infer folds.
If none takes all folds not included in <code class="docutils literal notranslate"><span class="pre">train_folds</span></code>
and <code class="docutils literal notranslate"><span class="pre">valid_folds</span></code></p></li>
<li><p><strong>tag2class</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em><em>, </em><em>optional</em>) – mapping from label names into int</p></li>
<li><p><strong>tag_column</strong> (<em>str</em><em>, </em><em>optional</em>) – column with label names</p></li>
<li><p><strong>class_column</strong> (<em>str</em><em>, </em><em>optional</em>) – column to use for split</p></li>
<li><p><strong>seed</strong> – seed for split</p></li>
<li><p><strong>n_folds</strong> – number of folds</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>tuple with 4 dataframes</dt><dd><p>whole dataframe, train part, valid part and infer part</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.pandas.split_dataframe_on_column_folds">
<code class="sig-prename descclassname">catalyst.contrib.utils.pandas.</code><code class="sig-name descname">split_dataframe_on_column_folds</code><span class="sig-paren">(</span><em class="sig-param">dataframe: pandas.core.frame.DataFrame</em>, <em class="sig-param">column: str</em>, <em class="sig-param">random_state: int = 42</em>, <em class="sig-param">n_folds: int = 5</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="reference internal" href="../_modules/catalyst/contrib/utils/pandas.html#split_dataframe_on_column_folds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.pandas.split_dataframe_on_column_folds" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits DataFrame into <cite>N</cite> folds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> – a dataset</p></li>
<li><p><strong>column</strong> – which column to use</p></li>
<li><p><strong>random_state</strong> – seed for random shuffle</p></li>
<li><p><strong>n_folds</strong> – number of result folds</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new dataframe with <cite>fold</cite> column</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.pandas.split_dataframe_on_folds">
<code class="sig-prename descclassname">catalyst.contrib.utils.pandas.</code><code class="sig-name descname">split_dataframe_on_folds</code><span class="sig-paren">(</span><em class="sig-param">dataframe: pandas.core.frame.DataFrame</em>, <em class="sig-param">random_state: int = 42</em>, <em class="sig-param">n_folds: int = 5</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="reference internal" href="../_modules/catalyst/contrib/utils/pandas.html#split_dataframe_on_folds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.pandas.split_dataframe_on_folds" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits DataFrame into <cite>N</cite> folds.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> – a dataset</p></li>
<li><p><strong>random_state</strong> – seed for random shuffle</p></li>
<li><p><strong>n_folds</strong> – number of result folds</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new dataframe with <cite>fold</cite> column</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.pandas.split_dataframe_on_stratified_folds">
<code class="sig-prename descclassname">catalyst.contrib.utils.pandas.</code><code class="sig-name descname">split_dataframe_on_stratified_folds</code><span class="sig-paren">(</span><em class="sig-param">dataframe: pandas.core.frame.DataFrame</em>, <em class="sig-param">class_column: str</em>, <em class="sig-param">random_state: int = 42</em>, <em class="sig-param">n_folds: int = 5</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="reference internal" href="../_modules/catalyst/contrib/utils/pandas.html#split_dataframe_on_stratified_folds"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.pandas.split_dataframe_on_stratified_folds" title="Permalink to this definition">¶</a></dt>
<dd><p>Splits DataFrame into <cite>N</cite> stratified folds.</p>
<p>Also see <a class="reference internal" href="data.html#catalyst.data.sampler.BalanceClassSampler" title="catalyst.data.sampler.BalanceClassSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.data.sampler.BalanceClassSampler</span></code></a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> – a dataset</p></li>
<li><p><strong>class_column</strong> – which column to use for split</p></li>
<li><p><strong>random_state</strong> – seed for random shuffle</p></li>
<li><p><strong>n_folds</strong> – number of result folds</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new dataframe with <cite>fold</cite> column</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.pandas.split_dataframe_train_test">
<code class="sig-prename descclassname">catalyst.contrib.utils.pandas.</code><code class="sig-name descname">split_dataframe_train_test</code><span class="sig-paren">(</span><em class="sig-param">dataframe: pandas.core.frame.DataFrame</em>, <em class="sig-param">**train_test_split_args</em><span class="sig-paren">)</span> &#x2192; Tuple[pandas.core.frame.DataFrame, pandas.core.frame.DataFrame]<a class="reference internal" href="../_modules/catalyst/contrib/utils/pandas.html#split_dataframe_train_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.pandas.split_dataframe_train_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Split dataframe in train and test part.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> – pd.DataFrame to split</p></li>
<li><p><strong>**train_test_split_args</strong> – <dl class="simple">
<dt>test_size<span class="classifier">float, int, or None (default is None)</span></dt><dd><p>If float, should be between 0.0 and 1.0 and represent the
proportion of the dataset to include in the test split. If
int, represents the absolute number of test samples. If None,
the value is automatically set
to the complement of the train size.
If train size is also None, test size is set to 0.25.</p>
</dd>
<dt>train_size<span class="classifier">float, int, or None (default is None)</span></dt><dd><p>If float, should be between 0.0 and 1.0 and represent the
proportion of the dataset to include in the train split. If
int, represents the absolute number of train samples. If None,
the value is automatically set
to the complement of the test size.</p>
</dd>
<dt>random_state<span class="classifier">int or RandomState</span></dt><dd><p>Pseudo-random number generator state used for random sampling.</p>
</dd>
<dt>stratify<span class="classifier">array-like or None (default is None)</span></dt><dd><p>If not None, data is split in a stratified fashion,
using this as the class labels.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>train and test DataFrames</p>
</dd>
</dl>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It exist cause sklearn <cite>split</cite> is overcomplicated.</p>
</div>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.pandas.separate_tags">
<code class="sig-prename descclassname">catalyst.contrib.utils.pandas.</code><code class="sig-name descname">separate_tags</code><span class="sig-paren">(</span><em class="sig-param">dataframe: pandas.core.frame.DataFrame</em>, <em class="sig-param">tag_column: str = 'tag'</em>, <em class="sig-param">tag_delim: str = '</em>, <em class="sig-param">'</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="reference internal" href="../_modules/catalyst/contrib/utils/pandas.html#separate_tags"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.pandas.separate_tags" title="Permalink to this definition">¶</a></dt>
<dd><p>Separates values in <code class="docutils literal notranslate"><span class="pre">class_column</span></code> column.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> – a dataset</p></li>
<li><p><strong>tag_column</strong> – column name to separate values</p></li>
<li><p><strong>tag_delim</strong> – delimiter to separate values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new dataframe</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.pandas.read_multiple_dataframes">
<code class="sig-prename descclassname">catalyst.contrib.utils.pandas.</code><code class="sig-name descname">read_multiple_dataframes</code><span class="sig-paren">(</span><em class="sig-param">in_csv_train: str = None</em>, <em class="sig-param">in_csv_valid: str = None</em>, <em class="sig-param">in_csv_infer: str = None</em>, <em class="sig-param">tag2class: Optional[Dict[str</em>, <em class="sig-param">int]] = None</em>, <em class="sig-param">class_column: str = None</em>, <em class="sig-param">tag_column: str = None</em><span class="sig-paren">)</span> &#x2192; Tuple[pandas.core.frame.DataFrame, pandas.core.frame.DataFrame, pandas.core.frame.DataFrame, pandas.core.frame.DataFrame]<a class="reference internal" href="../_modules/catalyst/contrib/utils/pandas.html#read_multiple_dataframes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.pandas.read_multiple_dataframes" title="Permalink to this definition">¶</a></dt>
<dd><p>This function reads train/valid/infer dataframes from giving paths.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_csv_train</strong> – paths to train csv separated by commas</p></li>
<li><p><strong>in_csv_valid</strong> – paths to valid csv separated by commas</p></li>
<li><p><strong>in_csv_infer</strong> – paths to infer csv separated by commas</p></li>
<li><p><strong>tag2class</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em><em>, </em><em>optional</em>) – mapping from label names into int</p></li>
<li><p><strong>tag_column</strong> (<em>str</em><em>, </em><em>optional</em>) – column with label names</p></li>
<li><p><strong>class_column</strong> (<em>str</em><em>, </em><em>optional</em>) – column to use for split</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><dl class="simple">
<dt>tuple with 4 dataframes</dt><dd><p>whole dataframe, train part, valid part and infer part</p>
</dd>
</dl>
</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>tuple</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.pandas.map_dataframe">
<code class="sig-prename descclassname">catalyst.contrib.utils.pandas.</code><code class="sig-name descname">map_dataframe</code><span class="sig-paren">(</span><em class="sig-param">dataframe: pandas.core.frame.DataFrame, tag_column: str, class_column: str, tag2class: Dict[str, int], verbose: bool = False</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="reference internal" href="../_modules/catalyst/contrib/utils/pandas.html#map_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.pandas.map_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>This function maps tags from <code class="docutils literal notranslate"><span class="pre">tag_column</span></code> to ints into
<code class="docutils literal notranslate"><span class="pre">class_column</span></code> using <code class="docutils literal notranslate"><span class="pre">tag2class</span></code> dictionary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> – input dataframe</p></li>
<li><p><strong>tag_column</strong> – column with tags</p></li>
<li><p><strong>class_column</strong> (<em>str</em>) – </p></li>
<li><p><strong>tag2class</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em>) – mapping from tags to class labels</p></li>
<li><p><strong>verbose</strong> – flag if true, uses tqdm</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>updated dataframe with <code class="docutils literal notranslate"><span class="pre">class_column</span></code></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.pandas.get_dataset_labeling">
<code class="sig-prename descclassname">catalyst.contrib.utils.pandas.</code><code class="sig-name descname">get_dataset_labeling</code><span class="sig-paren">(</span><em class="sig-param">dataframe: pandas.core.frame.DataFrame</em>, <em class="sig-param">tag_column: str</em><span class="sig-paren">)</span> &#x2192; Dict[str, int]<a class="reference internal" href="../_modules/catalyst/contrib/utils/pandas.html#get_dataset_labeling"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.pandas.get_dataset_labeling" title="Permalink to this definition">¶</a></dt>
<dd><p>Prepares a mapping using unique values from <code class="docutils literal notranslate"><span class="pre">tag_column</span></code>.</p>
<div class="highlight-javascript notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
    <span class="s2">&quot;class_name_0&quot;</span><span class="o">:</span> <span class="mf">0</span><span class="p">,</span>
    <span class="s2">&quot;class_name_1&quot;</span><span class="o">:</span> <span class="mf">1</span><span class="p">,</span>
    <span class="p">...</span>
    <span class="s2">&quot;class_name_N&quot;</span><span class="o">:</span> <span class="nx">N</span>
<span class="p">}</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> – a dataset</p></li>
<li><p><strong>tag_column</strong> – which column to use</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>mapping from tag to labels</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Dict[str, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.pandas.merge_multiple_fold_csv">
<code class="sig-prename descclassname">catalyst.contrib.utils.pandas.</code><code class="sig-name descname">merge_multiple_fold_csv</code><span class="sig-paren">(</span><em class="sig-param">fold_name: str, paths: Optional[str]</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="reference internal" href="../_modules/catalyst/contrib/utils/pandas.html#merge_multiple_fold_csv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.pandas.merge_multiple_fold_csv" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads csv into one DataFrame with column <code class="docutils literal notranslate"><span class="pre">fold</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fold_name</strong> – current fold name</p></li>
<li><p><strong>paths</strong> – paths to csv separated by commas</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>merged dataframes with column <code class="docutils literal notranslate"><span class="pre">fold</span></code> == <code class="docutils literal notranslate"><span class="pre">fold_name</span></code></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.pandas.read_csv_data">
<code class="sig-prename descclassname">catalyst.contrib.utils.pandas.</code><code class="sig-name descname">read_csv_data</code><span class="sig-paren">(</span><em class="sig-param">in_csv: str = None</em>, <em class="sig-param">train_folds: Optional[List[int]] = None</em>, <em class="sig-param">valid_folds: Optional[List[int]] = None</em>, <em class="sig-param">infer_folds: Optional[List[int]] = None</em>, <em class="sig-param">seed: int = 42</em>, <em class="sig-param">n_folds: int = 5</em>, <em class="sig-param">in_csv_train: str = None</em>, <em class="sig-param">in_csv_valid: str = None</em>, <em class="sig-param">in_csv_infer: str = None</em>, <em class="sig-param">tag2class: Optional[Dict[str</em>, <em class="sig-param">int]] = None</em>, <em class="sig-param">class_column: str = None</em>, <em class="sig-param">tag_column: str = None</em><span class="sig-paren">)</span> &#x2192; Tuple[pandas.core.frame.DataFrame, List[dict], List[dict], List[dict]]<a class="reference internal" href="../_modules/catalyst/contrib/utils/pandas.html#read_csv_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.pandas.read_csv_data" title="Permalink to this definition">¶</a></dt>
<dd><p>From giving path <code class="docutils literal notranslate"><span class="pre">in_csv</span></code> reads a dataframe
and split it to train/valid/infer folds
or from several paths <code class="docutils literal notranslate"><span class="pre">in_csv_train</span></code>, <code class="docutils literal notranslate"><span class="pre">in_csv_valid</span></code>, <code class="docutils literal notranslate"><span class="pre">in_csv_infer</span></code>
reads independent folds.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<dl class="simple">
<dt>This function can be used with different combinations of params.</dt><dd><dl class="simple">
<dt>First block is used to get dataset from one <cite>csv</cite>:</dt><dd><p>in_csv, train_folds, valid_folds, infer_folds, seed, n_folds</p>
</dd>
<dt>Second includes paths to different csv for train/valid and infer parts:</dt><dd><p>in_csv_train, in_csv_valid, in_csv_infer</p>
</dd>
<dt>The other params (tag2class, tag_column, class_column) are optional</dt><dd><p>for any previous block</p>
</dd>
</dl>
</dd>
</dl>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>in_csv</strong> – paths to whole dataset</p></li>
<li><p><strong>train_folds</strong> – train folds</p></li>
<li><p><strong>valid_folds</strong> (<em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – valid folds.
If none takes all folds not included in <code class="docutils literal notranslate"><span class="pre">train_folds</span></code></p></li>
<li><p><strong>infer_folds</strong> (<em>List</em><em>[</em><em>int</em><em>]</em><em>, </em><em>optional</em>) – infer folds.
If none takes all folds not included in <code class="docutils literal notranslate"><span class="pre">train_folds</span></code>
and <code class="docutils literal notranslate"><span class="pre">valid_folds</span></code></p></li>
<li><p><strong>seed</strong> – seed for split</p></li>
<li><p><strong>n_folds</strong> – number of folds</p></li>
<li><p><strong>in_csv_train</strong> – paths to train csv separated by commas</p></li>
<li><p><strong>in_csv_valid</strong> – paths to valid csv separated by commas</p></li>
<li><p><strong>in_csv_infer</strong> – paths to infer csv separated by commas</p></li>
<li><p><strong>tag2class</strong> (<em>Dict</em><em>[</em><em>str</em><em>, </em><em>int</em><em>]</em>) – mapping from label names into ints</p></li>
<li><p><strong>tag_column</strong> – column with label names</p></li>
<li><p><strong>class_column</strong> – column to use for split</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple with 4 elements
(whole dataframe,
list with train data,
list with valid data
and list with infer data)</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Tuple[pd.DataFrame, List[dict], List[dict], List[dict]]</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.pandas.balance_classes">
<code class="sig-prename descclassname">catalyst.contrib.utils.pandas.</code><code class="sig-name descname">balance_classes</code><span class="sig-paren">(</span><em class="sig-param">dataframe: pandas.core.frame.DataFrame</em>, <em class="sig-param">class_column: str = 'label'</em>, <em class="sig-param">random_state: int = 42</em>, <em class="sig-param">how: str = 'downsampling'</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="reference internal" href="../_modules/catalyst/contrib/utils/pandas.html#balance_classes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.pandas.balance_classes" title="Permalink to this definition">¶</a></dt>
<dd><p>Balance classes in dataframe by <code class="docutils literal notranslate"><span class="pre">class_column</span></code>.</p>
<p>See also <a class="reference internal" href="data.html#catalyst.data.sampler.BalanceClassSampler" title="catalyst.data.sampler.BalanceClassSampler"><code class="xref py py-class docutils literal notranslate"><span class="pre">catalyst.data.sampler.BalanceClassSampler</span></code></a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataframe</strong> – a dataset</p></li>
<li><p><strong>class_column</strong> – which column to use for split</p></li>
<li><p><strong>random_state</strong> – seed for random shuffle</p></li>
<li><p><strong>how</strong> – strategy to sample, must be one on [“downsampling”, “upsampling”]</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new dataframe with balanced <code class="docutils literal notranslate"><span class="pre">class_column</span></code></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><strong>NotImplementedError</strong> – if <cite>how</cite> is not in [“upsampling”, “downsampling”, int]</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.pandas.create_dataset">
<code class="sig-prename descclassname">catalyst.contrib.utils.pandas.</code><code class="sig-name descname">create_dataset</code><span class="sig-paren">(</span><em class="sig-param">dirs: str</em>, <em class="sig-param">extension: str = None</em>, <em class="sig-param">process_fn: Callable[str</em>, <em class="sig-param">object] = None</em>, <em class="sig-param">recursive: bool = False</em><span class="sig-paren">)</span> &#x2192; Dict[str, object]<a class="reference internal" href="../_modules/catalyst/contrib/utils/pandas.html#create_dataset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.pandas.create_dataset" title="Permalink to this definition">¶</a></dt>
<dd><p>Create dataset (dict like <cite>{key: [values]}</cite>) from vctk-like dataset:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span><span class="o">/</span>
    <span class="n">cat</span><span class="o">/</span>
        <span class="o">*.</span><span class="n">ext</span>
    <span class="n">dog</span><span class="o">/</span>
        <span class="o">*.</span><span class="n">ext</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dirs</strong> – path to dirs, for example /home/user/data/**</p></li>
<li><p><strong>extension</strong> – data extension you are looking for</p></li>
<li><p><strong>process_fn</strong> (<em>Callable</em><em>[</em><em>[</em><em>str</em><em>]</em><em>, </em><em>object</em><em>]</em>) – function(path_to_file) -&gt; object
process function for found files, by default</p></li>
<li><p><strong>recursive</strong> – enables recursive globbing</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dataset</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.pandas.create_dataframe">
<code class="sig-prename descclassname">catalyst.contrib.utils.pandas.</code><code class="sig-name descname">create_dataframe</code><span class="sig-paren">(</span><em class="sig-param">dataset: Dict[str, object], **dataframe_args</em><span class="sig-paren">)</span> &#x2192; pandas.core.frame.DataFrame<a class="reference internal" href="../_modules/catalyst/contrib/utils/pandas.html#create_dataframe"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.pandas.create_dataframe" title="Permalink to this definition">¶</a></dt>
<dd><p>Create pd.DataFrame from dict like <cite>{key: [values]}</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – dict like <cite>{key: [values]}</cite></p></li>
<li><p><strong>**dataframe_args</strong> – <dl class="simple">
<dt>index<span class="classifier">Index or array-like</span></dt><dd><p>Index to use for resulting frame.
Will default to np.arange(n) if no indexing information
part of input data and no index provided</p>
</dd>
<dt>columns<span class="classifier">Index or array-like</span></dt><dd><p>Column labels to use for resulting frame. Will default to
np.arange(n) if no column labels are provided</p>
</dd>
<dt>dtype<span class="classifier">dtype, default None</span></dt><dd><p>Data type to force, otherwise infer</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dataframe from giving dataset</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>pd.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.pandas.split_dataset_train_test">
<code class="sig-prename descclassname">catalyst.contrib.utils.pandas.</code><code class="sig-name descname">split_dataset_train_test</code><span class="sig-paren">(</span><em class="sig-param">dataset: pandas.core.frame.DataFrame</em>, <em class="sig-param">**train_test_split_args</em><span class="sig-paren">)</span> &#x2192; Tuple[Dict[str, object], Dict[str, object]]<a class="reference internal" href="../_modules/catalyst/contrib/utils/pandas.html#split_dataset_train_test"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.pandas.split_dataset_train_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Split dataset in train and test parts.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dataset</strong> – dict like dataset</p></li>
<li><p><strong>**train_test_split_args</strong> – <dl class="simple">
<dt>test_size<span class="classifier">float, int, or None (default is None)</span></dt><dd><p>If float, should be between 0.0 and 1.0 and represent the
proportion of the dataset to include in the test split. If
int, represents the absolute number of test samples. If None,
the value is automatically set
to the complement of the train size.
If train size is also None, test size is set to 0.25.</p>
</dd>
<dt>train_size<span class="classifier">float, int, or None (default is None)</span></dt><dd><p>If float, should be between 0.0 and 1.0 and represent the
proportion of the dataset to include in the train split. If
int, represents the absolute number of train samples. If None,
the value is automatically set
to the complement of the test size.</p>
</dd>
<dt>random_state<span class="classifier">int or RandomState</span></dt><dd><p>Pseudo-random number generator state used for random sampling.</p>
</dd>
<dt>stratify<span class="classifier">array-like or None (default is None)</span></dt><dd><p>If not None, data is split in a stratified fashion,
using this as the class labels.</p>
</dd>
</dl>
</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>train and test dicts</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-catalyst.contrib.utils.parallel">
<span id="parallel"></span><h3><a class="toc-backref" href="#id21">Parallel</a><a class="headerlink" href="#module-catalyst.contrib.utils.parallel" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.contrib.utils.parallel.parallel_imap">
<code class="sig-prename descclassname">catalyst.contrib.utils.parallel.</code><code class="sig-name descname">parallel_imap</code><span class="sig-paren">(</span><em class="sig-param">func, args, pool: Union[multiprocessing.pool.Pool, catalyst.contrib.utils.parallel.DumbPool]</em><span class="sig-paren">)</span> &#x2192; List[T]<a class="reference internal" href="../_modules/catalyst/contrib/utils/parallel.html#parallel_imap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.parallel.parallel_imap" title="Permalink to this definition">¶</a></dt>
<dd><p>&#64;TODO: Docs. Contribution is welcome.</p>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.parallel.tqdm_parallel_imap">
<code class="sig-prename descclassname">catalyst.contrib.utils.parallel.</code><code class="sig-name descname">tqdm_parallel_imap</code><span class="sig-paren">(</span><em class="sig-param">func, args, pool: Union[multiprocessing.pool.Pool, catalyst.contrib.utils.parallel.DumbPool], total: int = None, pbar=&lt;class 'tqdm.std.tqdm'&gt;</em><span class="sig-paren">)</span> &#x2192; List[T]<a class="reference internal" href="../_modules/catalyst/contrib/utils/parallel.html#tqdm_parallel_imap"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.parallel.tqdm_parallel_imap" title="Permalink to this definition">¶</a></dt>
<dd><p>&#64;TODO: Docs. Contribution is welcome.</p>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.parallel.get_pool">
<code class="sig-prename descclassname">catalyst.contrib.utils.parallel.</code><code class="sig-name descname">get_pool</code><span class="sig-paren">(</span><em class="sig-param">workers: int</em><span class="sig-paren">)</span> &#x2192; Union[multiprocessing.pool.Pool, catalyst.contrib.utils.parallel.DumbPool]<a class="reference internal" href="../_modules/catalyst/contrib/utils/parallel.html#get_pool"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.parallel.get_pool" title="Permalink to this definition">¶</a></dt>
<dd><p>&#64;TODO: Docs. Contribution is welcome.</p>
</dd></dl>

</div>
<div class="section" id="module-catalyst.contrib.utils.plotly">
<span id="plotly"></span><h3><a class="toc-backref" href="#id22">Plotly</a><a class="headerlink" href="#module-catalyst.contrib.utils.plotly" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.contrib.utils.plotly.plot_tensorboard_log">
<code class="sig-prename descclassname">catalyst.contrib.utils.plotly.</code><code class="sig-name descname">plot_tensorboard_log</code><span class="sig-paren">(</span><em class="sig-param">logdir: Union[str, pathlib.Path], step: Optional[str] = 'batch', metrics: Optional[List[str]] = None, height: Optional[int] = None, width: Optional[int] = None</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/contrib/utils/plotly.html#plot_tensorboard_log"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.plotly.plot_tensorboard_log" title="Permalink to this definition">¶</a></dt>
<dd><p>&#64;TODO: Docs. Contribution is welcome.</p>
<p>Adapted from
<a class="reference external" href="https://github.com/belskikh/kekas/blob/v0.1.23/kekas/utils.py#L193">https://github.com/belskikh/kekas/blob/v0.1.23/kekas/utils.py#L193</a></p>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.plotly.plot_metrics">
<code class="sig-prename descclassname">catalyst.contrib.utils.plotly.</code><code class="sig-name descname">plot_metrics</code><span class="sig-paren">(</span><em class="sig-param">logdir: Union[str, pathlib.Path], step: Optional[str] = 'epoch', metrics: Optional[List[str]] = None, height: Optional[int] = None, width: Optional[int] = None</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/contrib/utils/plotly.html#plot_metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.plotly.plot_metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots your learning results.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>logdir</strong> – the logdir that was specified during training.</p></li>
<li><p><strong>step</strong> – ‘batch’ or ‘epoch’ - what logs to show: for batches or
for epochs</p></li>
<li><p><strong>metrics</strong> – list of metrics to plot. The loss should be specified as
‘loss’, learning rate = ‘_base/lr’ and other metrics should be
specified as names in metrics dict
that was specified during training</p></li>
<li><p><strong>height</strong> – the height of the whole resulting plot</p></li>
<li><p><strong>width</strong> – the width of the whole resulting plot</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-catalyst.contrib.utils.serialization">
<span id="serialization"></span><h3><a class="toc-backref" href="#id23">Serialization</a><a class="headerlink" href="#module-catalyst.contrib.utils.serialization" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.contrib.utils.serialization.serialize">
<code class="sig-prename descclassname">catalyst.contrib.utils.serialization.</code><code class="sig-name descname">serialize</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="headerlink" href="#catalyst.contrib.utils.serialization.serialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Serialize the data into bytes using pickle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> – a value</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns a bytes object serialized with pickle data.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.serialization.deserialize">
<code class="sig-prename descclassname">catalyst.contrib.utils.serialization.</code><code class="sig-name descname">deserialize</code><span class="sig-paren">(</span><em class="sig-param">bytes</em><span class="sig-paren">)</span><a class="headerlink" href="#catalyst.contrib.utils.serialization.deserialize" title="Permalink to this definition">¶</a></dt>
<dd><p>Deserialize bytes into an object using pickle.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bytes</strong> – a bytes object containing serialized with pickle data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns a value deserialized from the bytes-like object.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="id1">
<h3><a class="toc-backref" href="#id24">Torch</a><a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h3>
<span class="target" id="module-catalyst.contrib.utils.torch_extra"></span><dl class="function">
<dt id="catalyst.contrib.utils.torch_extra.calculate_tp_fp_fn">
<code class="sig-prename descclassname">catalyst.contrib.utils.torch_extra.</code><code class="sig-name descname">calculate_tp_fp_fn</code><span class="sig-paren">(</span><em class="sig-param">confusion_matrix: numpy.ndarray</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/catalyst/contrib/utils/torch_extra.html#calculate_tp_fp_fn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.torch_extra.calculate_tp_fp_fn" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculated TP, FP, FN statistics from confusion matrix.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>confusion_matrix</strong> – confusion matrix, np.ndarray</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dictionary with TP, FP, FN statistics</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.torch_extra.calculate_confusion_matrix_from_arrays">
<code class="sig-prename descclassname">catalyst.contrib.utils.torch_extra.</code><code class="sig-name descname">calculate_confusion_matrix_from_arrays</code><span class="sig-paren">(</span><em class="sig-param">predictions: numpy.ndarray</em>, <em class="sig-param">labels: numpy.ndarray</em>, <em class="sig-param">num_classes: int</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/catalyst/contrib/utils/torch_extra.html#calculate_confusion_matrix_from_arrays"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.torch_extra.calculate_confusion_matrix_from_arrays" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate confusion matrix for a given set of classes.
If labels value is outside of the [0, num_classes) it is excluded.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictions</strong> – model predictions</p></li>
<li><p><strong>labels</strong> – ground truth labels</p></li>
<li><p><strong>num_classes</strong> – number of classes</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>confusion matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.torch_extra.calculate_confusion_matrix_from_tensors">
<code class="sig-prename descclassname">catalyst.contrib.utils.torch_extra.</code><code class="sig-name descname">calculate_confusion_matrix_from_tensors</code><span class="sig-paren">(</span><em class="sig-param">y_pred_logits: torch.Tensor</em>, <em class="sig-param">y_true: torch.Tensor</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/catalyst/contrib/utils/torch_extra.html#calculate_confusion_matrix_from_tensors"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.torch_extra.calculate_confusion_matrix_from_tensors" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate confusion matrix from tensors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_pred_logits</strong> – model logits</p></li>
<li><p><strong>y_true</strong> – true labels</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>confusion matrix</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-catalyst.contrib.utils.visualization">
<span id="visualization"></span><h3><a class="toc-backref" href="#id25">Visualization</a><a class="headerlink" href="#module-catalyst.contrib.utils.visualization" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.contrib.utils.visualization.plot_confusion_matrix">
<code class="sig-prename descclassname">catalyst.contrib.utils.visualization.</code><code class="sig-name descname">plot_confusion_matrix</code><span class="sig-paren">(</span><em class="sig-param">cm</em>, <em class="sig-param">class_names=None</em>, <em class="sig-param">normalize=False</em>, <em class="sig-param">title='confusion matrix'</em>, <em class="sig-param">fname=None</em>, <em class="sig-param">show=True</em>, <em class="sig-param">figsize=12</em>, <em class="sig-param">fontsize=32</em>, <em class="sig-param">colormap='Blues'</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/utils/visualization.html#plot_confusion_matrix"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.visualization.plot_confusion_matrix" title="Permalink to this definition">¶</a></dt>
<dd><p>Render the confusion matrix and return matplotlib”s figure with it.
Normalization can be applied by setting <cite>normalize=True</cite>.</p>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.visualization.render_figure_to_tensor">
<code class="sig-prename descclassname">catalyst.contrib.utils.visualization.</code><code class="sig-name descname">render_figure_to_tensor</code><span class="sig-paren">(</span><em class="sig-param">figure</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/utils/visualization.html#render_figure_to_tensor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.visualization.render_figure_to_tensor" title="Permalink to this definition">¶</a></dt>
<dd><p>&#64;TODO: Docs. Contribution is welcome.</p>
</dd></dl>

</div>
<div class="section" id="module-catalyst.contrib.utils.wizard">
<span id="wizard"></span><h3><a class="toc-backref" href="#id26">Wizard</a><a class="headerlink" href="#module-catalyst.contrib.utils.wizard" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.contrib.utils.wizard.run_wizard">
<code class="sig-prename descclassname">catalyst.contrib.utils.wizard.</code><code class="sig-name descname">run_wizard</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/utils/wizard.html#run_wizard"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.wizard.run_wizard" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to initialize and run wizard.</p>
</dd></dl>

<dl class="class">
<dt id="catalyst.contrib.utils.wizard.Wizard">
<em class="property">class </em><code class="sig-prename descclassname">catalyst.contrib.utils.wizard.</code><code class="sig-name descname">Wizard</code><a class="reference internal" href="../_modules/catalyst/contrib/utils/wizard.html#Wizard"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.wizard.Wizard" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for Catalyst Config API Wizard.</p>
<p>The instance of this class will be created and called from cli command:
<code class="docutils literal notranslate"><span class="pre">catalyst-dl</span> <span class="pre">init</span> <span class="pre">--interactive</span></code>.</p>
<p>With help of this Wizard user will be able to setup pipeline from available
templates and make choices of what predefined classes to use in different
parts of pipeline.</p>
<dl class="method">
<dt id="catalyst.contrib.utils.wizard.Wizard.__init__">
<code class="sig-name descname">__init__</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/utils/wizard.html#Wizard.__init__"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.wizard.Wizard.__init__" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialization of instance of this class will print welcome message and
logo of Catalyst in ASCII format. Also here we’ll save all classes of
Catalyst own pipeline parts to be able to put user’s modules on top of
lists to ease the choice.</p>
</dd></dl>

<dl class="method">
<dt id="catalyst.contrib.utils.wizard.Wizard.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/utils/wizard.html#Wizard.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.wizard.Wizard.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Walks user through predefined wizard steps.</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.wizard.clone_pipeline">
<code class="sig-prename descclassname">catalyst.contrib.utils.wizard.</code><code class="sig-name descname">clone_pipeline</code><span class="sig-paren">(</span><em class="sig-param">template: str</em>, <em class="sig-param">out_dir: pathlib.Path</em><span class="sig-paren">)</span> &#x2192; None<a class="reference internal" href="../_modules/catalyst/contrib/utils/wizard.html#clone_pipeline"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.wizard.clone_pipeline" title="Permalink to this definition">¶</a></dt>
<dd><p>Clones pipeline from empty pipeline template or from demo pipelines
available in Git repos of Catalyst Team.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>template</strong> – type of pipeline you want to clone.
empty/classification/segmentation</p></li>
<li><p><strong>out_dir</strong> – path where pipeline directory should be cloned</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-catalyst.contrib.utils.cv">
<span id="computer-vision"></span><h2><a class="toc-backref" href="#id27">Computer Vision</a><a class="headerlink" href="#module-catalyst.contrib.utils.cv" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-catalyst.contrib.utils.cv.image">
<span id="image"></span><h3><a class="toc-backref" href="#id28">Image</a><a class="headerlink" href="#module-catalyst.contrib.utils.cv.image" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.contrib.utils.cv.image.has_image_extension">
<code class="sig-prename descclassname">catalyst.contrib.utils.cv.image.</code><code class="sig-name descname">has_image_extension</code><span class="sig-paren">(</span><em class="sig-param">uri</em><span class="sig-paren">)</span> &#x2192; bool<a class="reference internal" href="../_modules/catalyst/contrib/utils/cv/image.html#has_image_extension"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.cv.image.has_image_extension" title="Permalink to this definition">¶</a></dt>
<dd><p>Check that file has image extension.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>uri</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>pathlib.Path</em><em>]</em>) – the resource to load the file from</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True if file has image extension, False otherwise</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bool</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.cv.image.imread">
<code class="sig-prename descclassname">catalyst.contrib.utils.cv.image.</code><code class="sig-name descname">imread</code><span class="sig-paren">(</span><em class="sig-param">uri</em>, <em class="sig-param">grayscale: bool = False</em>, <em class="sig-param">expand_dims: bool = True</em>, <em class="sig-param">rootpath: Union[str</em>, <em class="sig-param">pathlib.Path] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/catalyst/contrib/utils/cv/image.html#imread"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.cv.image.imread" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads an image from the specified file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uri</strong> (<em>str</em><em>, </em><em>pathlib.Path</em><em>, </em><em>bytes</em><em>, </em><em>file</em>) – the resource to load the image
from, e.g. a filename, <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code>, http address or file object,
see <code class="docutils literal notranslate"><span class="pre">imageio.imread</span></code> docs for more info</p></li>
<li><p><strong>grayscale</strong> – if True, make all images grayscale</p></li>
<li><p><strong>expand_dims</strong> – if True, append channel axis to grayscale images
rootpath (Union[str, pathlib.Path]): path to the resource with image
(allows to use relative path)</p></li>
<li><p><strong>rootpath</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>pathlib.Path</em><em>]</em>) – path to the resource with image
(allows to use relative path)</p></li>
<li><p><strong>**kwargs</strong> – extra params for image read</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>image</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.cv.image.imwrite">
<code class="sig-prename descclassname">catalyst.contrib.utils.cv.image.</code><code class="sig-name descname">imwrite</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/utils/cv/image.html#imwrite"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.cv.image.imwrite" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">imwrite(uri,</span> <span class="pre">im,</span> <span class="pre">format=None,</span> <span class="pre">**kwargs)</span></code></p>
<p>Write an image to the specified file.
Alias for <code class="docutils literal notranslate"><span class="pre">imageio.imwrite</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – parameters for <code class="docutils literal notranslate"><span class="pre">imageio.imwrite</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>image save result</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.cv.image.imsave">
<code class="sig-prename descclassname">catalyst.contrib.utils.cv.image.</code><code class="sig-name descname">imsave</code><span class="sig-paren">(</span><em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/utils/cv/image.html#imsave"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.cv.image.imsave" title="Permalink to this definition">¶</a></dt>
<dd><p><code class="docutils literal notranslate"><span class="pre">imwrite(uri,</span> <span class="pre">im,</span> <span class="pre">format=None,</span> <span class="pre">**kwargs)</span></code></p>
<p>Write an image to the specified file.
Alias for <code class="docutils literal notranslate"><span class="pre">imageio.imsave</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>**kwargs</strong> – parameters for <code class="docutils literal notranslate"><span class="pre">imageio.imsave</span></code></p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>image save result</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.cv.image.mask_to_overlay_image">
<code class="sig-prename descclassname">catalyst.contrib.utils.cv.image.</code><code class="sig-name descname">mask_to_overlay_image</code><span class="sig-paren">(</span><em class="sig-param">image: numpy.ndarray, masks: List[numpy.ndarray], threshold: float = 0, mask_strength: float = 0.5</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/catalyst/contrib/utils/cv/image.html#mask_to_overlay_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.cv.image.mask_to_overlay_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Draws every mask for with some color over image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>image</strong> – RGB image used as underlay for masks</p></li>
<li><p><strong>masks</strong> – list of masks</p></li>
<li><p><strong>threshold</strong> – threshold for masks binarization</p></li>
<li><p><strong>mask_strength</strong> – opacity of colorized masks</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>HxWx3 image with overlay</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.cv.image.mimread">
<code class="sig-prename descclassname">catalyst.contrib.utils.cv.image.</code><code class="sig-name descname">mimread</code><span class="sig-paren">(</span><em class="sig-param">uri</em>, <em class="sig-param">clip_range: Tuple[int</em>, <em class="sig-param">int] = None</em>, <em class="sig-param">expand_dims: bool = True</em>, <em class="sig-param">rootpath: Union[str</em>, <em class="sig-param">pathlib.Path] = None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/catalyst/contrib/utils/cv/image.html#mimread"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.cv.image.mimread" title="Permalink to this definition">¶</a></dt>
<dd><p>Reads multiple images from the specified file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>uri</strong> (<em>str</em><em>, </em><em>pathlib.Path</em><em>, </em><em>bytes</em><em>, </em><em>file</em>) – the resource to load the image
from, e.g. a filename, <code class="docutils literal notranslate"><span class="pre">pathlib.Path</span></code>, http address or file object,
see <code class="docutils literal notranslate"><span class="pre">imageio.mimread</span></code> docs for more info</p></li>
<li><p><strong>clip_range</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em>) – lower and upper interval edges,
image values outside the interval are clipped to the interval edges</p></li>
<li><p><strong>expand_dims</strong> – if True, append channel axis to grayscale images
rootpath (Union[str, pathlib.Path]): path to the resource with image
(allows to use relative path)</p></li>
<li><p><strong>rootpath</strong> (<em>Union</em><em>[</em><em>str</em><em>, </em><em>pathlib.Path</em><em>]</em>) – path to the resource with image
(allows to use relative path)</p></li>
<li><p><strong>**kwargs</strong> – extra params for image read</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>image</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.cv.image.mimwrite_with_meta">
<code class="sig-prename descclassname">catalyst.contrib.utils.cv.image.</code><code class="sig-name descname">mimwrite_with_meta</code><span class="sig-paren">(</span><em class="sig-param">uri</em>, <em class="sig-param">ims</em>, <em class="sig-param">meta</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/utils/cv/image.html#mimwrite_with_meta"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.cv.image.mimwrite_with_meta" title="Permalink to this definition">¶</a></dt>
<dd><p>&#64;TODO: Docs. Contribution is welcome.</p>
</dd></dl>

</div>
<div class="section" id="module-catalyst.contrib.utils.cv.tensor">
<span id="tensor"></span><h3><a class="toc-backref" href="#id29">Tensor</a><a class="headerlink" href="#module-catalyst.contrib.utils.cv.tensor" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.contrib.utils.cv.tensor.tensor_from_rgb_image">
<code class="sig-prename descclassname">catalyst.contrib.utils.cv.tensor.</code><code class="sig-name descname">tensor_from_rgb_image</code><span class="sig-paren">(</span><em class="sig-param">image: numpy.ndarray</em><span class="sig-paren">)</span> &#x2192; torch.Tensor<a class="reference internal" href="../_modules/catalyst/contrib/utils/cv/tensor.html#tensor_from_rgb_image"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.cv.tensor.tensor_from_rgb_image" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates tensor from RGB image.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>image</strong> – RGB image stored as np.ndarray</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tensor</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.cv.tensor.tensor_to_ndimage">
<code class="sig-prename descclassname">catalyst.contrib.utils.cv.tensor.</code><code class="sig-name descname">tensor_to_ndimage</code><span class="sig-paren">(</span><em class="sig-param">images: torch.Tensor</em>, <em class="sig-param">denormalize: bool = True</em>, <em class="sig-param">mean: Tuple[float</em>, <em class="sig-param">float</em>, <em class="sig-param">float] = (0.485</em>, <em class="sig-param">0.456</em>, <em class="sig-param">0.406)</em>, <em class="sig-param">std: Tuple[float</em>, <em class="sig-param">float</em>, <em class="sig-param">float] = (0.229</em>, <em class="sig-param">0.224</em>, <em class="sig-param">0.225)</em>, <em class="sig-param">move_channels_dim: bool = True</em>, <em class="sig-param">dtype=&lt;class 'numpy.float32'&gt;</em><span class="sig-paren">)</span> &#x2192; numpy.ndarray<a class="reference internal" href="../_modules/catalyst/contrib/utils/cv/tensor.html#tensor_to_ndimage"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.cv.tensor.tensor_to_ndimage" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert float image(s) with standard normalization to
np.ndarray with [0..1] when dtype is np.float32 and [0..255]
when dtype is <cite>np.uint8</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>images</strong> – [B]xCxHxW float tensor</p></li>
<li><p><strong>denormalize</strong> – if True, multiply image(s) by std and add mean</p></li>
<li><p><strong>mean</strong> (<em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>, </em><em>float</em><em>]</em>) – per channel mean to add</p></li>
<li><p><strong>std</strong> (<em>Tuple</em><em>[</em><em>float</em><em>, </em><em>float</em><em>, </em><em>float</em><em>]</em>) – per channel std to multiply</p></li>
<li><p><strong>move_channels_dim</strong> – if True, convert tensor to [B]xHxWxC format</p></li>
<li><p><strong>dtype</strong> – result ndarray dtype. Only float32 and uint8 are supported</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>[B]xHxWxC np.ndarray of dtype</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
<div class="section" id="module-catalyst.contrib.utils.nlp">
<span id="natural-language-processing"></span><h2><a class="toc-backref" href="#id30">Natural language processing</a><a class="headerlink" href="#module-catalyst.contrib.utils.nlp" title="Permalink to this headline">¶</a></h2>
<div class="section" id="module-catalyst.contrib.utils.nlp.text">
<span id="text"></span><h3><a class="toc-backref" href="#id31">Text</a><a class="headerlink" href="#module-catalyst.contrib.utils.nlp.text" title="Permalink to this headline">¶</a></h3>
<dl class="function">
<dt id="catalyst.contrib.utils.nlp.text.tokenize_text">
<code class="sig-prename descclassname">catalyst.contrib.utils.nlp.text.</code><code class="sig-name descname">tokenize_text</code><span class="sig-paren">(</span><em class="sig-param">text: str</em>, <em class="sig-param">tokenizer</em>, <em class="sig-param">max_length: int</em>, <em class="sig-param">strip: bool = True</em>, <em class="sig-param">lowercase: bool = True</em>, <em class="sig-param">remove_punctuation: bool = True</em><span class="sig-paren">)</span> &#x2192; Dict[str, numpy.array]<a class="reference internal" href="../_modules/catalyst/contrib/utils/nlp/text.html#tokenize_text"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.nlp.text.tokenize_text" title="Permalink to this definition">¶</a></dt>
<dd><p>Tokenizes givin text.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>text</strong> – text to tokenize</p></li>
<li><p><strong>tokenizer</strong> – Tokenizer instance from HuggingFace</p></li>
<li><p><strong>max_length</strong> – maximum length of tokens</p></li>
<li><p><strong>strip</strong> – if true strips text before tokenizing</p></li>
<li><p><strong>lowercase</strong> – if true makes text lowercase before tokenizing</p></li>
<li><p><strong>remove_punctuation</strong> – if true
removes <code class="docutils literal notranslate"><span class="pre">string.punctuation</span></code> from text before tokenizing</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>batch with tokenized text</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="catalyst.contrib.utils.nlp.text.process_bert_output">
<code class="sig-prename descclassname">catalyst.contrib.utils.nlp.text.</code><code class="sig-name descname">process_bert_output</code><span class="sig-paren">(</span><em class="sig-param">bert_output</em>, <em class="sig-param">hidden_size: int</em>, <em class="sig-param">output_hidden_states: bool = False</em>, <em class="sig-param">pooling_groups: List[str] = None</em>, <em class="sig-param">mask: torch.Tensor = None</em>, <em class="sig-param">level: Union[int</em>, <em class="sig-param">str] = None</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/catalyst/contrib/utils/nlp/text.html#process_bert_output"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#catalyst.contrib.utils.nlp.text.process_bert_output" title="Permalink to this definition">¶</a></dt>
<dd><p>Processed BERT output.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bert_output</strong> – BERT output</p></li>
<li><p><strong>hidden_size</strong> – hidden size of BERT layers</p></li>
<li><p><strong>output_hidden_states</strong> – boolean flag if we need BERT hidden states</p></li>
<li><p><strong>pooling_groups</strong> – list with pooling to use for sequence embedding</p></li>
<li><p><strong>mask</strong> – boolean flag if we need mask <code class="docutils literal notranslate"><span class="pre">[PAD]</span></code> tokens</p></li>
<li><p><strong>level</strong> – integer with specified level to use</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>processed output</p>
</dd>
</dl>
</dd></dl>

</div>
</div>
</div>


             </article>
             
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="typing.html" class="btn btn-neutral" title="Typing" accesskey="p" rel="prev"><img src="../_static/images/chevron-right-orange.svg" class="previous-page"> Previous</a>
      
    </div>
  

  <hr>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, Scitator.

    </p>
  </div>
    
      <div>
        Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
      </div>
     

</footer>

          </div>
        </div>

        <div class="catalyst-content-right" id="catalyst-content-right">
          <div class="catalyst-right-menu" id="catalyst-right-menu">
            <div class="catalyst-side-scroll" id="catalyst-side-scroll-right">
              <ul>
<li><a class="reference internal" href="#">Utilities</a><ul>
<li><a class="reference internal" href="#module-catalyst.utils">Main</a><ul>
<li><a class="reference internal" href="#module-catalyst.utils.checkpoint">Checkpoint</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.components">Components</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.config">Config</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.distributed">Distributed</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.loaders">Loaders</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.misc">Misc</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.numpy">Numpy</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.parser">Parser</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.pruning">Pruning</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.quantization">Quantization</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.scripts">Scripts</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.swa">Stochastic Weights Averaging (SWA)</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.sys">Sys</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.torch">Torch</a></li>
<li><a class="reference internal" href="#module-catalyst.utils.tracing">Tracing</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-catalyst.contrib.utils">Contrib</a><ul>
<li><a class="reference internal" href="#module-catalyst.contrib.utils.compression">Compression</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.utils.pandas">Pandas</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.utils.parallel">Parallel</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.utils.plotly">Plotly</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.utils.serialization">Serialization</a></li>
<li><a class="reference internal" href="#id1">Torch</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.utils.visualization">Visualization</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.utils.wizard">Wizard</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-catalyst.contrib.utils.cv">Computer Vision</a><ul>
<li><a class="reference internal" href="#module-catalyst.contrib.utils.cv.image">Image</a></li>
<li><a class="reference internal" href="#module-catalyst.contrib.utils.cv.tensor">Tensor</a></li>
</ul>
</li>
<li><a class="reference internal" href="#module-catalyst.contrib.utils.nlp">Natural language processing</a><ul>
<li><a class="reference internal" href="#module-catalyst.contrib.utils.nlp.text">Text</a></li>
</ul>
</li>
</ul>
</li>
</ul>

            </div>
          </div>
        </div>
      </section>
    </div>

  


  

     
       <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
         <script type="text/javascript" src="../_static/jquery.js"></script>
         <script type="text/javascript" src="../_static/underscore.js"></script>
         <script type="text/javascript" src="../_static/doctools.js"></script>
         <script type="text/javascript" src="../_static/language_data.js"></script>
         <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
     

  

  <script type="text/javascript" src="../_static/js/vendor/popper.min.js"></script>
  <script type="text/javascript" src="../_static/js/vendor/bootstrap.min.js"></script>
  <script type="text/javascript" src="../_static/js/theme.js"></script>

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

  <!-- Begin Footer -->

  <footer class="site-footer" id="site-footer">
    <div class="container footer-container">
      <div class="footer-logo-wrapper">
        <a href="https://catalyst-team.com/" class="footer-logo"></a>
      </div>

      <div class="footer-links-wrapper">
        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://github.com/catalyst-team">Ecosystem</a></li>
            <li><a class="nav-dropdown-item" href="https://alchemy.host">Alchemy</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/catalyst">Catalyst</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/reaction">Reaction</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://github.com/catalyst-team">Projects</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/codestyle">Codestyle</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/neuro">Catalyst.Neuro</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/classification">Classification</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/detection">Detection</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/segmentation">Segmentation</a></li>
            <li><a class="nav-dropdown-item" href="https://github.com/catalyst-team/gan">Catalyst.GAN</a></li>
          </ul>
        </div>

        <div class="footer-links-col">
          <ul>
            <li class="list-title"><a href="https://catalyst-team.com/">Support</a></li>
            <li><a href="https://github.com/catalyst-team/catalyst/issues" target="_blank">Github Issues</a></li>
            <li><a href="https://github.com/catalyst-team/catalyst/blob/master/CONTRIBUTING.md" target="_blank">Contributing</a></li>
            <li><a href="https://www.patreon.com/catalyst_team" target="_blank">Patreon</a></li>
          </ul>
        </div>

        <div class="footer-links-col follow-us-col">
          <div class="footer-social-icons">
            <a href="https://t.me/catalyst_team" target="_blank" class="telegram"></a>
            <a href="https://twitter.com/catalyst_core" target="_blank" class="twitter"></a>
            <a href="https://join.slack.com/t/catalyst-team-core/shared_invite/zt-d9miirnn-z86oKDzFMKlMG4fgFdZafw" target="_blank" class="ods"></a>
          </div>
        </div>
      </div>
    </div>
  </footer>


  <!-- End Footer -->

  <!-- Begin Mobile Menu -->

  <div class="mobile-main-menu">
    <div class="container-fluid">
      <div class="container">
        <div class="mobile-main-menu-header-container">
          <a class="header-logo" href="https://catalyst-team.com/" aria-label="Catalyst"></a>
          <a class="main-menu-close-button" href="#" data-behavior="close-mobile-menu"></a>
        </div>
      </div>
    </div>

    <div class="mobile-main-menu-links-container">
      <div class="main-menu">
        <ul>
          <li>
            <a href="">Get Started</a>
          </li>

          <li>
            <a href="https://github.com/catalyst-team/catalyst">Github</a>
          </li>
        </ul>
      </div>
    </div>
  </div>

  <!-- End Mobile Menu -->

  <script type="text/javascript" src="../_static/js/vendor/anchor.min.js"></script>

  <script type="text/javascript">
    $(document).ready(function() {
      mobileMenu.bind();
      mobileTOC.bind();
      catalystAnchors.bind();
      sideMenus.bind();
      scrollToAnchor.bind();
      highlightNavigation.bind();
      mainMenuDropdown.bind();

      // Add class to links that have code blocks, since we cannot create links in code blocks
      $("article.catalyst-article a span.pre").each(function(e) {
        $(this).closest("a").addClass("has-code");
      });
    })
  </script>
</body>
</html>